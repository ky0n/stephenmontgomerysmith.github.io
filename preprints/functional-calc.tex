\documentclass[12pt,reqno]{amsart}

\usepackage{url}
\usepackage{bm}
\usepackage{amssymb}

\newcommand\bi{\bm i}
\newcommand\bj{\bm j}
\newcommand\bk{\bm k}
\newcommand\tint{{\textstyle\int\!}}

\newcommand\starop[1]{#1^\star}

\newcommand\setdualquat{D}
\newcommand\setunitdualquat{SD}
\newcommand\setpuredualquat{\mathfrak{sd}}

\DeclareMathOperator\realpart{Re}
\DeclareMathOperator\imagpart{Im}
\newcommand{\liediff}{\mathbin{\triangle}}
\newcommand{\liederiv}{\mathcal L}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{cor}[theorem]{Corollary}
\newtheorem{prop}[theorem]{Proposition}

\begin{document}

\title{Functional calculus for dual quaternions}
\author{Stephen Montgomery-Smith}
\address{Department of Mathematics, University of Missouri, Columbia, MO 65211.}
\email{stephen@missouri.edu}
\urladdr{https://stephenmontgomerysmith.github.io}

\begin{abstract}  We give a formula for $f(\eta)$, where $f :\mathbb C \to \mathbb C$ is a continuously differentiable function satisfying
$f(\bar z) = \overline{f(z)}$,
and $\eta$ is a dual quaternion.  Note this formula is straightforward or well known if $\eta$ is merely a dual number or a quaternion.  If one is willing to prove the result only when $f$ is a polynomial, then the methods of this paper are elementary.
\end{abstract}

\maketitle

A \emph{quaternion} is a quadruple of real numbers, written as $A = w + x \bi + y \bj + z \bk$, with the algebraic operations $\bi^2 = \bj^2 = \bk^2 = \bi \bj \bk = -1$.  Its \emph{conjugate} is $\bar A = A = w - x \bi - y \bj - z \bk$.  Its \emph{norm} is $|A| = (w^2+x^2+y^2+z^2)^{1/2}$.  It is called a \emph{pure} quaternion if $w = 0$.  We identify 3-vectors with pure quaternions, by identifying $\bi$, $\bj$, and $\bk$ with the three standard unit vectors.  A \emph{dual number} is a pair of real numbers, written as $\alpha = a + \epsilon b$, with the algebraic operation $\epsilon^2 = 0$.  A \emph{dual quaternion} is a pair of quaternions, written as $\eta = A + \epsilon B$, again with $\epsilon^2 = 0$.  The \emph{conjugate} of this dual quaternion is $\bar \eta = \bar A + \epsilon \bar B$.  The notion of dual quaternion goes back to Clifford \cite{clifford}.  For more information, including how they are used by the graphics card industry and in robotics, we refer the reader to \cite{adorno,han-et-al,kavan-et-al,kavan-et-al-2,kenwright,wiki-2,yang-et-al}.

The symbol $i$ denotes one of the square roots of $-1$, and in this paper won't be identified with $\bi$.

We say that a function $f:\Omega \to \mathbb C$ is \emph{valid} if $\Omega$ is a subset of $\mathbb C$ such that $z\in\Omega \Leftrightarrow \bar z \in \Omega$, and
\begin{equation}
f(\bar z) = \overline{f(z)} \quad \text{for $z \in \Omega$.}
\end{equation}
Note that if $f(x+iy)$ is a polynomial in $x$ and $y$:
\begin{equation}
f(x+iy) = \sum_{m,n} r_{m,n} x^m (iy)^n.
\end{equation}
then $f$ is valid if and only if the $r_{m,n}$ are real.

We show how to extend the definition of $f$, at least when $f$ is appropriately smooth, to dual quaternions in such a way that it is correct for polynomials.  In all of the statements of our results, when we say that a class of functions extends to a subset of dual quaternions, we mean the following standard definition of a functional calculus.
\begin{enumerate}
\item The class of functions contains $f(z) = 1$, $f(z) = z$, and if $f$ and $g$ are in this class, and $a$ is a real number, then $f+g$, $fg$, $\bar f$, and $a f$ are also in this class.
\item Given any dual quaternion $\eta$ from the prescribed subset, there is a map from the class to dual quaternions, $f \mapsto f(\eta)$, such that $f(z) = 1$ maps to $1$, $f(z) = z$ maps to $\eta$, $f+g$ maps to $f(\eta) + g(\eta)$, $fg$ maps to $f(\eta) g(\eta)$, $\bar f$ maps to $\overline{f(\eta)}$, and $a f$ maps to $a f(\eta)$.
\item If any topology is specified on the class of functions, then the map $\eta \mapsto f(\eta)$ is continuous.
\end{enumerate}
All of the results of this paper could be verified for polynomials simply by looking at the individual monomials, and indeed this is how Lemmas~\ref{f(d)} and~\ref{f(dq) commute} are best proved.  Another method is to verify the results if $f(z) = 1$ and $f(z) = z$, and show that the set of functions for which it is true is closed under addition, multiplication, conjugation, and multiplication by real numbers.  However, for Lemma~\ref{f(dq) anti commute}, these straightforward approaches are nevertheless quite mysterious, and we believe that our approach is more intuitive.

Once the results are verified for polynomials, we can extend to the wider class of functions using the Stone-Weierstrass Theorem \cite{rudin}.

We should mention that the formula for dual numbers is well known \cite{wiki-1}, and indeed we cite it as Lemma~\ref{f(d)}.

If $f$ is continuously differentiable, denote
\begin{equation}
f_x(x+iy) = \dfrac{\partial}{\partial x} f(x+iy) , \quad
f_{iy}(x+iy) = -i\dfrac{\partial}{\partial y} f(x+iy) .
\end{equation}
(Thus the Cauchy-Riemann conditions can be stated as $f$ is analytic if and only if $f_x = f_{iy}$.)  Define the following real valued, continuous, functions, which are even in $y$:
\begin{align}
\label{g}
g(x+iy) &= \dfrac{f(x+iy) + f(x-iy)} 2, \\
\label{h}
h(x+iy) &= \begin{cases}
\dfrac{f(x+iy)-f(x-iy)}{2iy} &\text{if $y \ne 0$} \\
f_{iy} (x) &\text{if $y = 0$} ,
\end{cases}
\end{align}
so that
\begin{equation}
f(x+iy) = g(x+iy) + i y h(x+iy) .
\end{equation}

First we state how to extend $f$ to the quaternions.  The proof is straightforward, because any quaternion that is a unit 3-vector behaves formally exactly like $i$ in $\mathbb C$.

\begin{theorem}
\label{f(q)}
Suppose that $f:\Omega \to \mathbb C$ is a valid function.  Then $f$ extends to quaternions
\begin{equation}
f(a_0 + \bm a_1) = \begin{cases}
g(a_0+i|\bm a_1|) +h(a_0+i|\bm a_1|) \bm a_1 & \text{if $\bm a_1 \ne 0$} \\
f(a_0) & \text{if $\bm a_1 = 0$}, \end{cases}
\end{equation}
where $a_0$ is real and $\bm a_1$ is a 3-vector.  Furthermore the norm is preserved in that
\begin{equation}
| f(a_0 + \bm a_1) | = | f(a + i |\bm a_1|) | .
\end{equation}
\end{theorem}

If $f$ is a valid polynomial, then a formula that extends $f$ to all dual quaternions is essentially stated in \cite{wiki-1}.  If $A$ and $B$ are quaternions, then
\begin{equation}
\label{proto f(dq)}
f(A + \epsilon B) = f(A) + \epsilon \left.\frac d{dr} f(A + rB) \right|_{r=0}.
\end{equation}
If $A$ and $B$ commute, this immediately implies Lemma~\ref{f(dq) commute} below.  But if $A$ and $B$ do not commute, it is not immediately apparent how to use this formula.  Thus we now state the main result of this paper.

\begin{theorem}
\label{f(dq)}
Let $f:\Omega \to \mathbb C$ be a valid continuously differentiable function, where $\Omega$ is open in $\mathbb C$.  Define $h$ by equation~\eqref{h}.  Then $f$ can be extended to a continuous function on all dual quaternions as follows.  Given quaternions $A$ and $B$, decompose $A = a_0 + \bm a_1$ and $B = b_0 + \bm b_1 + \bm b_2$, where $a_0$ and $b_0$ are real, $\bm a_1$, $\bm b_1$ and $\bm b_2$ are 3-vectors, $\bm b_1$ is parallel to $\bm a_1$, and $\bm b_2$ is perpendicular to $\bm a_1$.  Write $B_1 = b_0 + \bm b_1$.  If $a + i |\bm a_1| \in \Omega$, then
\begin{align}
f(A + \epsilon B)
&= g(A) 
+ \epsilon f_x(A) b_0
+ h(A) (1 + \epsilon \bm b_2)
+ \epsilon f_{iy}(A) \bm b_1 \\
&= f(A) 
+ \epsilon f_x(A) b_0
+ \epsilon f_{iy}(A) \bm b_1
+ \epsilon h(A) \bm b_2 .
\end{align}
\end{theorem}

Before proving this result, let us provide some examples.  First, we compute the exponential function.

\begin{cor}
\label{exp dq}
With the hypotheses of Theorem~\ref{f(dq)} we have
\label{exp theta}
\begin{multline}
\exp(A + \epsilon B ) \\
= e^{a_0} \left(\left(\cos(|\bm a_1|) + \dfrac{\sin(|\bm a_1|)}{|\bm a_1|} \bm a_1 \right) \left(1 + \epsilon B_1\right) + \epsilon\frac{\sin(|\bm a_1|)}{|\bm a_1|} \bm b_2\right),
\end{multline}
where if $\bm a_1 = 0$, we set $\sin(|\bm a_1|)/|\bm a_1| = 1$.
\end{cor}

We can compute the logarithm in the same way, but then we can only get the principal value.  Instead we define a logarithm as a right inverse to the exponential function: $\exp(\log(\eta)) = \eta$.  A formula for the logarithm is given in \cite{han-et-al}, but we believe that their formula only works if $A$ and $B$ commute.

\begin{cor}
\label{log dq}
Assume the hypotheses of Theorem~\ref{f(dq)}, with $A \ne 0$.  Let $t$ be the angle for a choice of polar coordinates for $(a_0, |\bm a_1|)$.  If $\bm a_1 \ne 0$, then a choice of $\log(A+\epsilon B)$ is
\begin{equation}
\log(|A|) + \dfrac t{|\bm a_1|} (\bm a_1 + \epsilon \bm b_2) + \epsilon \dfrac1{|A|^2} \bar A_1 B_1 .
\end{equation}
In the case $\bm a_1 = 0$, and $a_0 \ne 0$, we can assume $t = n \pi$ for some integer $n$, and $\bm b_2 = 0$.  Let $\bm p$ be any 3-vector perpendicular to $\bm b_1$ if $n \ne 0$, and $\bm p = 0$ if $n = 0$.  Then a choice of $\log(A + \epsilon B)$ is
\begin{equation}
\label{t=n pi}
\log(|a_0|) + n \pi \dfrac{\bm b_1}{|\bm b_1|} + \epsilon \dfrac 1{a_0} B_1 + \epsilon \bm p,
\end{equation}
where if $\bm b_1 = 0$, we interpret $\bm b_1 / |\bm b_1|$ as any unit 3-vector.
\end{cor}

Now we start the proof of Theorem~\ref{f(dq)}.  As stated above, these first two results come straight from equation~\eqref{proto f(dq)}.  Lemma~\ref{f(d)} is found in \cite{wiki-1}.

\begin{lemma}
\label{f(d)}
Let $f:\Omega \to \mathbb R$ be a continuously differentiable function, where $\Omega$ is open in $\mathbb R$.  Then $f$ extends to dual numbers $a + \epsilon b$ with $a \in \Omega$ by
\begin{equation}
\label{dual number case}
f(a + \epsilon b ) = f(a) + \epsilon f'(a) b_0 .
\end{equation}
\end{lemma}

\begin{lemma}
\label{f(dq) commute}
Let $f:\Omega \to \mathbb C$ be a valid continuously differentiable function, where $\Omega$ is open in $\mathbb C$.  Then $f$ extends to dual quaternions $A + \epsilon B$ where $A$ and $B$ commute with
\begin{equation}
\label{commuting case}
f(A + \epsilon B ) = f(A) + \epsilon f_x(A) b_0
+ \epsilon f_{iy}(A) \bm b_1 ,
\end{equation}
where $B = b_0 + \bm b_1$, $b_0$ is real, and $\bm b_1$ is a 3-vector.
\end{lemma}

\begin{lemma}
\label{f(dq) anti commute}
Let $f:\Omega \to \mathbb C$ be a valid continuously differentiable function, where $\Omega$ is an open subset of $i\mathbb R$.  Define the continuous real valued function
\begin{equation}
\label{h ident 2}
h(iy) = \begin{cases}
\dfrac{f(iy) - f(-iy)}{2iy} &\text{if $y \ne 0$} \\
f_{iy}(0) &\text{if $y = 0$} .
\end{cases}
\end{equation}
Then $f$ extends to dual quaternions of the form $\eta = \bm a + \epsilon \bm b_1 + \epsilon \bm b_2$, where $\bm a$, $\bm b_1$, and $\bm b_2$ are pure, $\bm b_1$ and $\bm a$ are parallel, and $\bm b_2$ and $\bm a$ are perpendicular, by the formula
\begin{equation}
\label{f(dq) anti commute equ}
f(\eta) = f(\bm a + \epsilon \bm b_1) + \epsilon h(\bm a) \bm b_2 ,
\end{equation}
\end{lemma}

\begin{proof}  Without loss of generality, we may assume that $f$ is a polynomial.  Define the function
\begin{equation}
g(iy) = f(iy) + f(-iy) .
\end{equation}
Since $g$ and $h$ are even polynomials, we can create polynomials $k$ and $l$ on an open subset of $[-\infty,0]$ by
\begin{equation}
k(z) = g(\sqrt z), \quad l(z) = h(\sqrt z) .
\end{equation}
Then we have the identities
\begin{equation}
\label{f g h k l ident}
f(z) = k(z^2) + l(z^2) z , \quad k(z^2) = g(z), \quad l(z^2) = h(z) .
\end{equation}
Let $\alpha = \bm a + \epsilon \bm b_1$, and $\beta = \epsilon\bm b_2$.  Use equation~\eqref{proto f(dq)} to replace $z$ with $\eta$ in equations~\eqref{f g h k l ident}.  Note that $\eta^2 = \alpha^2$.  Hence
\begin{equation}
\begin{aligned}
f(\eta)
&= k(\eta^2) + l(\eta^2) \eta = k(\alpha^2) + l(\alpha^2) \eta \\
&= g(\alpha) + h(\alpha) (\alpha + \beta) = f(\alpha) + h(\alpha) \beta.
\end{aligned}
\end{equation}
\end{proof}

\begin{proof}[Proof of Theorem~\ref{f(dq)}]
By Lemma~\ref{f(dq) commute}, we only need to show
\begin{equation}
f(A+\epsilon B) = f(A + \epsilon B_1) + \epsilon h(A) \bm b_2 .
\end{equation}
Without loss of generality, assume $f$ is a polynomial.  Define the functions $u,v:(\Omega-a_0) \cap i\mathbb R \to \mathbb C$ by
\begin{align}
u(iy) &= f(a_0 + iy) , \\
v(iy) &= f_{x}(a_0 + iy) b_0,
\end{align}
so that by Lemma~\ref{f(d)}, applied to the real and imaginary parts of $x \mapsto f(x + iy)$, and replacing $x$ by $a_0 + \epsilon b_0$, we have
\begin{equation}
f(a_0 + \epsilon b_0 + i y) = u(iy) + \epsilon v(iy) .
\end{equation}
Now apply Lemma~\ref{f(dq) anti commute} to $u$ and $v$.  (A second derivative of $f$ appears when applying the lemma to $v$, but this disappears in the final result because $\epsilon^2 = 0$.)
\end{proof}

Finally, we note that the methods of the proof of Lemma~\ref{f(dq) anti commute} give a cute, albeit simple, result for the Dunford-Riesz functional calculus of analytic functions on complex algebras \cite{dunford-et-al}.

\begin{prop}
\label{analytic}
Suppose $f:\Omega \to \mathbb C$ is an analytic function on an open subset $\Omega$ of $\mathbb C$ satisfying $z \in \Omega \Leftrightarrow -z \in \Omega$.  Define the analytic functions on $\{z^2 : z \in \Omega\}$ by
\begin{align}
\label{g a}
k(z) &= \dfrac{f(\sqrt z) + f(-\sqrt z)}{2} ,\\
\label{h a}
l(z) &= \begin{cases}
\dfrac{f(\sqrt z) - f(-\sqrt z)}{2\sqrt z} &\text{if $z \ne 0$} \\
f'(0) &\text{if $z = 0$} ,
\end{cases} \\
\end{align}
If $A$ and $B$ are anti-commuting elements of a complex algebra such that their spectra $\sigma(A) \cup \sigma(B) \cup \sigma(A+B) \subset \Omega$, then
\begin{equation}
f(A+B) = k(A^2+B^2) + (A+B) l(A^2+B^2) .
\end{equation}
\end{prop}

Applying this to $(A+B)^n$, where $n$ is a non-negative integer, gives the coefficients of the so called Pauli-Pascal triangle \cite{horn,sloane}.

\begin{thebibliography}{99}

\bibitem{adorno} Bruno Vilhena Adorno, Robot Kinematic Modeling and Control Based on Dual Quaternion Algebra -- Part I: Fundamentals, 2017, hal-01478225.

\bibitem{clifford} M.A. Clifford, Preliminary Sketch of Biquaternions, Proceedings of the London Mathematical Society, Volume s1-4, Issue 1, November 1871, Pages 381-395, \url{https://doi.org/10.1112/plms/s1-4.1.381}.

\bibitem{dunford-et-al} N. Dunford and J.T. Schwartz, Linear Operators, Part I: General Theory, Interscience, 1958.

\bibitem{han-et-al} Da-Peng Han, Qing Wei, and Ze-Xiang Li, Kinematic Control of Free Rigid Bodies Using Dual Quaternions, International Journal of Automation and Computing
05(3), July 2008, 319-324, DOI: 10.1007/s11633-008-0319-1.

\bibitem{horn} M.E. Horn, The Didactical Relevance of the Pauli Pascal Triangle, arXiv:physics/0611277 [physics.ed-ph], 2006.

\bibitem{kavan-et-al} L. Kavan, S. Collins, J. \u Z\'ara, C. O'Sullivan, Skinning with Dual Quaternions, \url{https://dl.acm.org/doi/pdf/10.1145/1230100.1230107}.

\bibitem{kavan-et-al-2} L. Kavan, S. Collins, J. \u Z\'ara, C. O'Sullivan, Geometric Skinning with Approximate Dual Quaternion Blending, ACM Transactions on Graphics, Vol. 27, No. 4, Article 105, Publication date: October 2008.

\bibitem{kenwright} Ben Kenwright, A Beginners Guide to Dual-Quaternions, What They Are, How They Work, and How to Use Them for 3D Character Hierarchies, \url{https://cs.gmu.edu/~jmlien/teaching/cs451/uploads/Main/dual-quaternion.pdf}.

\bibitem{rudin} Walter Rudin, Functional analysis, McGraw-Hill, ISBN 0-07-054236-8, (1973).

\bibitem{sloane} N.J.A. Sloane, Online Encyplopedia of Integer Sequences, A051159, Triangular array made of three copies of Pascal's triangle, \url{https://oeis.org/A051159}.

\bibitem{wiki-2} Wikipedia, Dual quaternion, \url{https://en.wikipedia.org/wiki/Dual_quaternion}.

\bibitem{wiki-1} Wikipedia, Dual number, \url{https://en.wikipedia.org/wiki/Dual_number#Differentiation}.

\bibitem{yang-et-al} XiaoLong Yang, HongTao Wu, Yao Li, Bai Chen, A dual quaternion solution to the forward kinematics of a class of six-DOF parallel robots with full or reductant actuation, Mechanism and Machine Theory 107 (2017) 27-36, \url{http://dx.doi.org/10.1016/j.mechmachtheory.2016.08.003}.
\end{thebibliography}

\end{document}

