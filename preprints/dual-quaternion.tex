\documentclass[reqno,12pt]{amsart}

\usepackage{url}
\usepackage{bm}
\usepackage{amssymb}

\makeatletter
\def\blfootnote{\gdef\@thefnmark{}\@footnotetext}
\makeatother

\newcommand\bi{\bm i}
\newcommand\bj{\bm j}
\newcommand\bk{\bm k}
\newcommand\tint{{\textstyle\int\!}}

\newcommand\starop[1]{#1^\star}

\newcommand\setdualquat{D}
\newcommand\setunitdualquat{SD}
\newcommand\setpuredualquat{\mathfrak{sd}}

\DeclareMathOperator\realpart{Re}
\DeclareMathOperator\imagpart{Im}
\newcommand{\liediff}{\mathbin{\triangle}}
\newcommand{\liederiv}{\mathcal L}

\newtheorem{assertion}{Assertion}
\newtheorem{assumption}{Assumption}
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}

\begin{document}

\title{Using dual quaternions in robotics}

\author{Stephen Montgomery-Smith}
\address{Department of Mathematics, University of Missouri, Columbia, MO 65211.}
\email{stephen@missouri.edu}
%\email{stephen.j.montgomery-smith@nasa.gov}
\urladdr{https://stephenmontgomerysmith.github.io}

\author{Cecil Shy}
\address{Johnson Space Center, 2101 E.~NASA Pkwy, Houston, TX 77058.}
\email{cecil.shy-1@nasa.gov}

\blfootnote{This is a preprint of a paper intended for submission to a journal.  Because changes may made before formal publication, this preprint is made available with the understanding that it is not to be cited or reproduced without permission of the author.}
\date{Feb 16, 2022}

\begin{abstract}
We advocate for the use of dual quaternions to represent poses and twists for robotics.  We show how to represent torques and forces using dual quaternions.  We introduce the notion of the Lie derivative, and explain how it can be used to calculate the behavior of actuators.  We show how to combine dual quaternions with the Newton-Raphson method to compute forward kinematics for parallel robots.  We derive the equations of motion in dual quaternion form.  This paper contains results we have not seen before, which are listed in the conclusion.
\end{abstract}

\maketitle

%\tableofcontents

\section{Introduction}

We assume that the reader is familiar with the notion of \emph{pose} and \emph{rigid motion}, and the use of quaternions to represent rotations.  We use the terms pose and rigid motion interchangeably, since a pose can be considered as a rigid motion relative to a fixed reference frame, and the mathematical operations to manipulate them are identical.  Thus we also use the terms rotation and orientation interchangeably, and similarly with translation and position.  We refer the reader to \cite{bottema-et-al,gallardo-alvarado}.

The use of dual quaternions to represent poses is well established, especially in the graphic card industry: \cite{adorno,han-et-al,clifford,kavan-et-al,kavan-et-al-2,kenwright,schilling1,schilling2,wang-et-al}.  However, in the robotics industry, it is more common to represent a pose using a quaternion (for the rotation) and a three dimensional vector (for the translation).  In this paper, we advocate for the use of dual quaternions.

Let us start with a general discussion of why people might want to represent rotations by unit quaternions instead of three by three orthogonal matrices with determinant $1$.  One reason given is that quaternions can be represented with only four numbers, whereas the matrix representation requires nine numbers.  Another representation commonly used are Euler angles, and these only require three numbers.  However, with Euler angles, the formula for composition of rotations is difficult to calculate.  Also, Euler angles suffer from gimbal lock, in which if the rotation takes certain values, the choice of Euler angles isn't unique, and discontinuities and singularities arise.  Quaternions suffer from no such problems.

But in modern times, computer memory is very cost effective, and communication is fast, thus the aformentioned advantages might seem trivial at first.  This begs the question: what other advantages do quaternions offer over matrices?  Quaternions represent a quantity with three degrees of freedom by a four dimensional vector, whereas matrices use a nine dimensional vector.  Suppose one obtains an approximation to a matrix or quaternion?  For example, this would be common when using Newton-Raphson to find a rotation satisfying some formula, or to interpolate between rotations.  So then one has to find a projection which takes the vector to an admissible vector, that is, a vector that actually represents a rotation.  And projecting from a nine dimensional quantity to a three dimensional quantity is going to be much harder than the similarly projection from the four dimensional vector.  (The projection from quaternions to unit quaternions is called the \emph{normalization}, and is defined in Section\ref{sec motivation}.  A suggestion of what such a projection would be for $(3 \times 3)$ matrices is given at the end of Section~\ref{sec final note}.)

For representing poses, the usual representation is by a three by three orthogonal matrix with determinant $1$ for the rotation, and a three dimensional vector for the translation, twelve dimensional in all.  This has a natural representation as a four by four matrix, as we explain Section~\ref{sec twists}.  A great advantage of this representation is the relationship between pose and twist:
\begin{equation}
\label{pose twist}
\frac d{dt} (\text{pose}) = (\text{pose}) \times (\text{twist}).
\end{equation}
where the multiplication is matrix multiplication, and a twist is a combination of angular velocity and translational velocity measured with respect to the moving frame.

Another natural representation used a lot is to use a quaternion and a three dimensional vector.  But this new representation has problems in that it is not clear how the above equation would work in this situation.  However, if one introduces the notion of the dual quaternion, which is an eight dimensional vector, equation~\eqref{pose twist} is still valid if one uses dual quaternion multiplication.

A challenge with dual quaternions is that they are abstract, which can make them harder to understand.  Mathematicians find value behind abstract computational ideas, but Engineers usually find the end result, `black box approach,' more useful.

A useful approach to developing intuition for dual quaternions is to understand the rules with their structure, and the mathematical operations needed to manipulate them, (that is, normalization, basis vector multiplication, pose differentiation).  Once one becomes comfortable with their form and function, the advantage of duel quaternions over other methods becomes more apparant.  For example, one realizes that computing the projection of an eight dimensional vector to the six degrees of freedom of a pose, is also quite simple.  (This projection is also called the normalization, and is defined in Section~\ref{sec poses}.)

This makes it very useful if one is using the Newton-Raphson Method to find a pose satisfying certain properties.  We show how the dual quaternion representation efficiently solves the forward kinematics problem.

Finally we consider the dynamics of poses, that is, the equations of motion of a rigid spinning body.  In any representation this can be quite difficult, because of both centripetal and precessional effects.  But from a theoretical perspective, using the dual quaternion representation is quite slick.

In summary, while the usual representation using Euler angles and translations is conceptually easy to understand, performing calculations can be difficult.  Whereas with dual quaternions, while the are initially conceptually hard to understand, when it comes to calculations they are much easier to work with.

\section{Motivation}
\label{sec motivation}

A \emph{pose}, or \emph{rigid motion}, is a rotation followed by a translation.  (Semantically, a pose is the position of the end effector of the robot, and thus different from a rigid motion, but mathematically they are the same if we consider a pose to be a rigid motion with respect to the stationary reference frame.)  The rotation is represented by a $(3 \times 3)$ orthogonal matrix $\mathsf R$ with determinant $1$.  A translation $\bm t$ is a vector in $\mathbb R^3$.  These represent the pose $(\mathsf R, \bm t)$:
\begin{equation}
\label{pose action}
\bm r \mapsto \mathsf R \bm r + \bm t .
\end{equation}
Composition of poses is written from right to left.  Thus
\begin{equation}
(\mathsf R_1, \bm t_1) \circ (\mathsf R_2, \bm t_2) = (\mathsf R_1 \mathsf R_2, \bm t_1 + \mathsf R_1 \bm t_2).
\end{equation}
One way to represent a pose is using a four by four matrix
\begin{equation}
\label{pose-matrix}
\begin{bmatrix} \mathsf R & \bm t \\ 0 & 1 \end{bmatrix}
 = \begin{bmatrix} \mathsf R_{11} & \mathsf R_{12} & \mathsf R_{13} & t_1 \\
                   \mathsf R_{21} & \mathsf R_{22} & \mathsf R_{23} & t_2 \\
                   \mathsf R_{31} & \mathsf R_{32} & \mathsf R_{33} & t_3 \\
                   0 & 0 & 0 & 1 \end{bmatrix} 
\end{equation}
Then composition of poses may be computed simply by multiplying matrices of the form~\eqref{pose-matrix}.  In the literature, the Lie group of rotations is often denoted $SO(3)$.  The Lie group of poses is often denoted $SE(3)$.

The problem with this representation is that twelve numbers are required to represent a pose.  Other problems, which we discuss below, is that of interpolating a sequence of poses, and of computing forward kinematics.

One common way to solve both of these problems is to represent the rotation by a unit quaternion \cite{quaternions1,quaternions2}, which we briefly describe here.  A \emph{quaternion} is a quadruple of real numbers, written as $A = w + x \bi + y \bj + z \bk$, with the algebraic operations $\bi^2 = \bj^2 = \bk^2 = \bi \bj \bk = -1$.  Its \emph{conjugate} is $\overline A = w - x \bi - y \bj - y \bk$, its \emph{norm} is $|A| = (w^2+x^2+y^2+z^2)^{1/2} = \sqrt{A \overline A} = \sqrt{\overline A A}$, its \emph{normalization} is $\widehat A = A/|A|$, its \emph{real part} is $\realpart(A) = w = \tfrac12(A + \overline A)$, and its \emph{imaginary part} is $\imagpart(A) = \bi x + \bj y + \bk z = \tfrac12(A - \overline A)$.  It is called a \emph{unit} quaternion if $|A| = 1$, a \emph{real} quaternion if $\imagpart(A) = 0$, and a \emph{pure} quaternion if $\realpart(A) = 0$.  Note the multiplicative inverse is given by $A^{-1} = \overline A/|A|^2$.

We identify three dimensional vectors with pure quaternions, by identifying $\bi$, $\bj$, and $\bk$ with the three standard unit vectors.  A unit quaternion $Q$ represents the rotation $\bm r \mapsto Q \bm r \overline Q$.  A rotation by angle $a$ about an axis $\bm s$, where $|\bm s| = 1$, has two unit quaternion representations: $\pm(\cos(\tfrac12 a) + \bm s \sin(\tfrac12 a))$.  Composition of rotations corresponds to multiplication of unit quaternions.  With some practice, it becomes easier to read a rotation from a quaternion than it does from Euler angles, the standard method of representing rotations.

We can represent quaternions as four dimensional vectors, and give it the inner product
\begin{equation}
A \cdot B = \realpart(A \overline B) = \realpart(\overline A B) .
\end{equation}

Then a way to represent poses is as a pair $(Q,\bm t)$.  This is the way poses are represented internally in the Robotic Operating System \cite{ros}.  Then the composition rule is
\begin{equation}
\label{pose-ros-compose}
(Q_1, \bm t_1) \circ (Q_2, \bm t_2) = (Q_1 Q_2, \bm t_1 + Q_1 \bm t_2 \overline Q_1).
\end{equation}
A difficulty with this is that the composition is not a bilinear operation as it was with the representation~\eqref{pose-matrix}.  (This lack of bilinear representation becomes particularly problematic when representing twists, which we describe below.)  However there is a way to resolve this as follows.  Write $B_1 = \tfrac12 \bm t_1 Q_1$ and $B_2 = \tfrac12 \bm t_2 Q_2$.  Then equation~\eqref{pose-ros-compose} can be rewritten as
\begin{equation}
\begin{aligned}
& (Q_1, 2 B_1 Q_1^{-1}) \circ (Q_2, 2 B_2 Q_2^{-1}) 
\\& = (Q_1 Q_2, 2 B_1 Q_1^{-1}+ 2 Q_1 B_2 Q_2^{-1} Q_1^{-1})
\\& = (Q_1 Q_2, 2 (B_1 Q_2 + Q_1 B_2)(Q_1 Q_2)^{-1}) .
\end{aligned}
\end{equation}
This leads to representing the pose $(Q,\bm t)$ by a unit dual quaternion, which we now describe.

\section{Dual quaternions to represent poses}
\label{sec poses}

A \emph{dual quaternion} is a pair of quaternions, written as $\eta = A + \epsilon B$, with the extra algebraic operation $\epsilon^2 = 0$.

The \emph{conjugate} dual quaternion of $\eta = \eta = A + \epsilon B$ is $\overline\eta = \overline A + \epsilon \overline B$.  Conjugation reverses the order of multiplication:
\begin{equation}
\overline{\eta_1\eta_2} = \overline \eta_2 \overline \eta_1 .
\end{equation}
There is another conjugation for dual quaternions: $(A + \epsilon B)^* = A - \epsilon B$, but we have no cause to use it in this paper, except in equation~\eqref{defn of pose on 3-vector} below.

A \emph{unit} dual quaternion $\eta = Q + \epsilon B$ is a dual quaternion such that $\overline\eta\eta = 1$, equivalently, that $Q$ is a unit quaternion and $B \cdot Q = 0$.  A \emph{pure} dual quaternion $A + \epsilon B$ is a dual quaternion such that both $A$ and $B$ are pure quaternions.

If $\eta = Q + \epsilon B$ is a dual quaternion with $Q \ne 0$, then its multiplicative inverse can be calculated using the formula
\begin{equation}
\eta^{-1} = Q^{-1} - \epsilon Q^{-1} B Q^{-1}.
\end{equation}
If $\eta$ is a unit dual quaternion, then there is a computationally much faster formula:
\begin{equation}
\label{inverse unit}
\eta^{-1} = \overline \eta.
\end{equation}

For a dual quaternion $A + \epsilon B$, it is not really possible to mix $A$ and $B$ additively.  The quaternion $A$ is unitless, whereas the quaternion $B$ has units of length.  For this reason, when measuring how large a dual quaternion is, everything must be with respect to $l$, the characteristic length scale.  The \emph{size} of a dual quaternion is defined to be
\begin{equation}
\label{size}
\|A+\epsilon B\| = \left(|A|^2 + l^{-2}|B|^2\right)^{1/2}.
\end{equation}

A \emph{dual number} is anything of the form $a + \epsilon b$, where $a$ and $b$ are real numbers.  The \emph{norm} of a dual quaternion $\eta = Q + \epsilon B$ is the dual number defined by the two steps:
\begin{gather}
|\eta|^2 = \overline{\eta} \eta = \eta \overline\eta = |Q|^2 + 2 \epsilon (B \cdot Q) ,\\
\label{norm}
|\eta| = \sqrt{|\eta|^2} = |Q| + \epsilon (B \cdot Q) / |Q| .
\end{gather}
The norm preserves multiplication, that is, if $\eta_1$ and $\eta_2$ are two dual quaternions, then
\begin{equation}
|\eta_1 \eta_2| = |\eta_1| |\eta_2| .
\end{equation}

If $\eta = Q + \epsilon B$ is any dual quaternion with $Q \ne 0$, then we define its \emph{normalization} to be the unit dual quaternion
\begin{equation}
\label{normalize}
\widehat \eta = |\eta|^{-1}\eta = \eta|\eta|^{-1}
= Q/|Q| + \epsilon (B - (B\cdot Q) Q/|Q|^2) .
\end{equation}
(We remark that the normalization of a dual quaternion is used in the computer graphics industry \cite{kavan-et-al, kavan-et-al-2}.)  While this normalization formula might seem initially quite complicated, after thinking about it one can see that it is the simplest projection that enforces $|Q| = 1$ and $B\cdot Q = 0$.

The normalization also satisfies the following properties.
\begin{itemize}
\item If $\eta$ is a unit dual quaternion, then $\widehat\eta = \eta$.
\item Normalization preserves multiplication, that is, if $\eta_1$ and $\eta_2$ are two dual quaternions, then
\begin{equation}
\widehat{\eta_1 \eta_2} = \widehat \eta_1 \widehat \eta_2 .
\end{equation}
\item If $\theta$ is pure, then
\begin{equation}
\label{approx normalize}
\widehat {(1+\theta)} = 1 + \theta + \tfrac12 \theta^2 + O(\theta^3).
\end{equation}
(See Section~\ref{sec proofs} for the proof of this.)
\end{itemize}
Note that
\begin{equation}
\eta^{-1} = |\eta|^{-2} \overline\eta,
\end{equation}
and this could have been the definition of the multiplicative inverse of a dual quaternion, except that this definition is circular.

Let us clarify the big-Oh notation.  We say that
\begin{equation}
\eta(\theta) = O(\gamma(\theta))
\end{equation}
if there exists a constant $c>0$ such that if $\|\theta\|$ is sufficiently small, then
\begin{equation}
\| \eta(\theta) \| \le c \| \gamma(\theta) \| .
\end{equation}

We set $\setdualquat$ for the set of dual quaternions, $\setunitdualquat$ for the set of unit dual quaternions, and $\setpuredualquat$ for the set of pure dual quaternions.

If we are given a pose represented by $(Q, \bm t)$, then the pose is also represented by the unit dual quaternion
\begin{equation}
\label{pose as dual quaternion}
\eta = Q + \tfrac12 \epsilon \bm t Q.
\end{equation}
As we have shown above, composition of poses corresponds to multiplication of unit dual quaternions.  If $\bm r$ is a 3-vector, and $\bm s$ is the image of $\bm r$ under the action of the pose $\eta = Q + \epsilon B$, then
\begin{equation}
\label{defn of pose on 3-vector}
1 + \epsilon \bm s = \eta (1 + \epsilon \bm r) \overline\eta^* ,
\end{equation}
but generally it is easier to use the formula
\begin{equation}
\label{pose on 3-vector}
\bm s = Q \bm r \overline Q + 2 B \overline Q = (Q \bm r + 2 B) \overline Q .
\end{equation}
The introduction of the factors $2$ and $\frac12$ is unnecessary, but it slightly improves formulas for the twist, as we see below.

It is difficult for a human to look at the second part of a unit dual quaternion, and from that read what the translational part of the pose should be.  So dual quaternions work better for an internal representations of poses rather than human readable representations.

One more notion is the exponential of a dual quaternion \cite{wang-et-al}:
\begin{equation}
\label{exponential}
\exp(\theta) = \sum_{k=0}^\infty \frac{\theta^k}{k!},
\end{equation}
The exponential map takes pure dual quaternions to unit dual quaternions.  In particular, if $\theta$ is a pure dual quaternion, then by equation~\eqref{approx normalize} we have
\begin{equation}
\label{exp-normal}
\exp(\theta) = \widehat{(1+\theta)} + O(\theta^3) .
\end{equation}
We show how to calculate $\exp(\theta)$ in Section~\ref{sec fun dq}.

\section{Kinematics: dual quaternions to represent twists}
\label{sec twists}

The translational velocity $\bm v$ of a translating reference frame is given by $\bm v = \dot{\bm t}$.  The angular velocity $\bm w = (w_1, w_2, w_3)$ of a rotating frame is given by the differential equation
\begin{equation}
\label{twist matrix}
\dot{\mathsf R} = \mathsf R \starop{\bm w},
\end{equation}
or $\starop{\bm w} = \mathsf R^{-1} \dot{\mathsf R}$,
where $\starop{\bm w}$ is the \emph{Hodge star operator} of $\bm w$ \cite{wiki0}:
\begin{equation}
\starop{\bm w} = \begin{bmatrix}  0   & -w_3 &  w_2 \\
                               w_3 &  0   & -w_1 \\
                              -w_2 &  w_1 &  0 \end{bmatrix} .
\end{equation}
(Equation~\eqref{twist matrix} gives the angular velocity with respect to the rotating reference frame.  If one wants the angular velocity with respect to the stationary reference frame, use instead $\dot{\mathsf R} = \starop{\bm w} \mathsf R$.)

Note that
\begin{equation}
\label{w star to w cross}
(\starop{\bm w}) \bm r = \bm w \times \bm r ,
\end{equation}
where $\times$ denotes the cross product.

A \emph{twist} is the pair of vectors $(\bm w, \bm v)$ that describe the change of pose in the moving reference frame, that is:
\begin{equation}
\label{ode twist}
\frac d{dt} \begin{bmatrix} \mathsf R & \bm t \\ 0 & 1 \end{bmatrix}
= \begin{bmatrix} \mathsf R & \bm t \\ 0 & 1 \end{bmatrix}
\begin{bmatrix} \starop{\bm w} & \bm v \\ 0 & 0 \end{bmatrix}.
\end{equation}
(Note in particular that $\dot{\bm t} = \mathsf R \bm v$, so that a continual application of a twist can result in a motion following a straight line, an arc of a circle, or a spiral.)  The set of angular velocities, and the set of twists are both Lie algebras, often denoted by $\mathfrak{so}(3)$ and $\mathfrak{se}(3)$ in the literature.

The quaternion-translation formulation doesn't have a representation like equation~\eqref{pose twist}:
\begin{equation}
\frac d{dt} (Q, \bm t) = \left(\tfrac12 Q \bm w, Q \bm v \overline Q \right).
\end{equation}
But with the unit dual representation, because the composition of poses is given by a bilinear multiplication, it follows that the twist is represented by the dual quaternion $\varphi$ satisfying the differential equation.
\begin{equation}
\label{ode dual quaternion}
\varphi = \eta^{-1} \dot \eta, \quad\text{or}\quad\dot \eta = \eta \varphi .
\end{equation}
It will be shown in Section~\ref{sec proofs} (see also \cite{han-et-al}) that $\varphi$ is the pure dual quaternion
\begin{equation}
\label{twist as dual quaternion}
\varphi = \tfrac12 \bm w + \tfrac12 \epsilon \bm v .
\end{equation}
Note that if $\eta$ is a unit dual quaternion that is a function of time $t$, then $\eta^{-1} \dot \eta$ is always a pure dual quaternion.  (Note that $\dot\eta\eta^{-1}$ is a pure dual quaternion equal to the twist relative to the fixed frame of reference.  Note also that the factor $\tfrac12$ attached to $\bm v$ in equation~\eqref{twist as dual quaternion} is a consequence of the introduction of the factor $\tfrac12$ in equation~\eqref{pose as dual quaternion}, and thus is essentially arbitrary.)

\section{Dual quaternions to represent wrenches}

Let the pose $\eta$ represent the reference frame that moves with the end effector.  It is not necessary (although it can simplify things) that the center of mass of the end effector coincides with the origin of the moving frame.

The \emph{wrench dual quaternion} is defined to be
\begin{equation}
\label{wrench as quaternion}
\tau = 2 \bm q + 2 \epsilon \bm p,
\end{equation}
where $\bm q$ and $\bm p$ are the torque and force, respectively, applied to the end effector at the origin of the moving frame, measured with respect to the moving frame.

If $\bm r_0$ is the center of mass of the end effector in the moving frame, then the twist about the center of mass is given by
\begin{equation}
\label{twist correction}
\varphi_0 = 
\varphi + \tfrac12\epsilon\bm w \times \bm r_0,
\end{equation}
where $\varphi = \eta^{-1} \dot \eta$, and the wrench applied about the center of mass is
\begin{equation}
\label{torque correction}
\tau_0 = 
\tau + 2 \bm p \times \bm r_0.
\end{equation}

The reason for introducing the factor $2$ in definition~\eqref{wrench as quaternion} is so that the rate of change of work done to the end effector is given by
\begin{equation}
\label{dot h tau varphi}
\frac{d}{dt} \text{(work done)} = \tau \cdot \varphi = \tau_0 \cdot \varphi_0 .
\end{equation}

See \cite{ball} for the origins of the term twist and wrench as pairs of 3-vectors, which are examples of \emph{screws}.

\section{Interpolation of poses}

Suppose that we are given a sequence of times and rotations, $t_0 < t_1 < \dots < t_n$ and $\mathsf R_0, \mathsf R_1, \dots, \mathsf R_n$.  We would like to find a function $\mathsf F$ from $[t_1,t_n]$ to rotations such that the third derivative of $\mathsf F$ is bounded, and $\mathsf F(t_k) = \mathsf R_k$.  If the quantities $\mathsf R_0, \mathsf R_1, \dots, \mathsf R_n$ were merely vectors, we could use cubic splines.  But if we perform a similar calculation on the matrices, we cannot guarantee that the matrix $\mathsf F(t)$ is a rotation matrix.

So what we want is to find a map that projects general matrices onto rotation matrices.  But it is not obvious how to find such a map that is computationally efficient.  It is here that using quaternions really has great advantages over matrices, because an obvious map from general quaternions to unit quaternions is to normalize.

Let $Q_0,Q_1,\dots,Q_n$ be the quaternion representation of $R_0, R_1, \dots, R_n$ respectively.  Let $G(t)$ be the cubic spline interpolation such that $G(t_k) = Q_k$.  Then
\begin{equation}
F(t) = \frac1{|G(t)|} G(t)
\end{equation}
provides a computationally fast, low jerk, method of interpolating the rotations.

This can be extended to interpolate poses.  Given times $t_0<t_1<\dots <t_n$ and unit dual quaternions $\eta_0, \eta_1, \dots, \eta_n$, first interpolate to get a function $\gamma$ such that $\gamma(t_k) = \alpha_k$, and then normalize it to get a function $\eta(t) = \widehat{\gamma(t)}$.  This gives a computationally fast, low jerk, method for interpolating poses.

It is perhaps better to interpolate the rotation quaternions and the translations separately.  This is because the center of gravity typically travels in a straight line rather than the arc of a curve, but naive interpolation of dual quaternions follows arcs of curves if the angular rotation is non-zero.  (Interpolation of dual quaternions is more appropriate for `skinning' \cite{kavan-et-al,kavan-et-al-2}.)

If one wants to find a function that passes through these points, and has low jerk even at the end points $t_0$ and $t_n$, this can be done by adding a `ramp up' and `ramp down' at the ends of the trajectory.  Create a free cubic spline $\gamma(t)$ on $\tfrac12(t_0+t_1)<t_1\dots<t_{n-1}<\tfrac12(t_{n-1}+t_n)$ and $\eta_0, \eta_1, \dots, \eta_n$.  Then define a function $s:\mathbb R \to [\tfrac12(t_0+t_1),\tfrac12(t_{n-1}+t_n)]$
\begin{equation}
s(t) = 
\begin{cases}
\tfrac12(t_0+t_1) & \text{if $t < t_0$} \\
t_0 + (t_1-t_0) f \left(\frac{t-t_0}{t_1-t_0}\right) & \text{if $t_0 \le t < t_1$} \\
t & \text{if $t_1 \le t < t_{n-1}$} \\
t_n - (t_n-t_{n-1}) f \left(\frac{t_n-t}{t_n-t_{n-1}}\right) & \text{if $t_{n-1} \le t < t_n$} \\
\tfrac12(t_{n-1}+t_n) & \text{if $t \ge t_n$}
\end{cases}
\end{equation}
where
\begin{equation}
f(t) = \tfrac12 + \tfrac12 (2-t) t^3 .
\end{equation}
Since $f(0) = \tfrac12$, $f'(0) = f''(0) = f''(1) = 0$, and $f(1) = f'(1) = 1$, it follows that $s(t)$ has bounded third derivative, $s(t_k) = t_k$ for $1 \le k \le n-1$, $s(t) = \tfrac12(t_0+t_1)$ for $t \le t_0$, and $s(t) = \tfrac12(t_{n-1}+t_n)$ for $t \ge t_n$.
Thus
\begin{equation}
\eta(t) = \widehat{\gamma(s(t))}
\end{equation}
provides a low jerk function, even at the end points, that passes through the appropriate points.  it is important that $t_1-t_0$ and $t_n-t_{n-1}$ be large enough to allow the trajectory to `ramp up' and `ramp down' smoothly.

\section{Perturbations of poses}

Suppose one has a pose $\eta = \eta(t)$ that varies in time, and a fixed time $t_0$.  Then we would like to find a good representation of the perturbation of $\eta(t)$ from a reference pose $\eta_r = \eta(t_0)$ when $t$ is close to $t_0$.  One way to do this is to choose a new reference frame in which $\eta_r = 1$, the identity pose, or rather, to think about how $\eta_r ^{-1} \eta$ behaves.

It can be seen that for $t$ close to $t_0$ that there is a pure dual quaternion $\theta$ such that
\begin{equation}
\eta = \eta_r \widehat{(1 + \theta)} \approx \eta_r (1 + \theta) .
\end{equation}
Thus
\begin{equation}
\label{proto approx lie diff}
\theta \approx \eta_r^{-1} \eta - 1 = \overline\eta_r \eta - 1
\end{equation}
gives a great way to measure the perturbation.

We prefer instead to use what we shall call the \emph{Lie difference}, which we denote using $\liediff$, which is close to \eqref{proto approx lie diff}, but is always a pure dual quaternion:
\begin{equation}
\theta \approx \eta\liediff\eta_r = \tfrac12 (\overline\eta_r \eta - \overline\eta \eta_r) = \imagpart(\overline\eta_r \eta).
\end{equation}
Note that if $\theta_1$ and $\theta_2$ are pure dual quaternions, and $\eta$ is an invertible dual quaternion, then
\begin{equation}
\label{approx approx lie diff}
\begin{aligned}
&(\eta(1+\theta_1)) \liediff (\eta(1+\theta_2)) \\&= (1+\theta_1) \liediff (1+\theta_2) \\&= \theta_1 - \theta_2 + O(|\theta_1|^2 + |\theta_2|^2).
\end{aligned}
\end{equation}
Thus these give a great way to map perturbations of non-linear poses to linear pure dual quaternions.  These can be very effective in control theory.

\section{Dual quaternions as vectors}

We make the identifications
\begin{equation}
\setdualquat \cong \mathbb R^8,
\end{equation}
using the basis
\begin{equation}
\{\beta_1, \beta_2, \beta_3, \beta_4, \beta_5, \beta_6, \beta_7, \beta_8\} = \{\bi, \bj, \bk, \epsilon\bi, \epsilon\bj, \epsilon\bk, 1, \epsilon\},
\end{equation}
and similarly, we make the identification
\begin{equation}
\setpuredualquat \cong \mathbb R^6,
\end{equation}
using the basis $\{\beta_1$, $\beta_2$, $\beta_3$, $\beta_4$, $\beta_5$, $\beta_6\}$.  With these identifications, we can define the dot product between two dual quaternions by transferring the usual definition of dot product on $\mathbb R^8$, that is
\begin{equation}
(A + \epsilon B) \cdot (C + \epsilon D) = A \cdot C + B \cdot D.
\end{equation}
In this way, every dual quaternion $\eta$ can be written in component form as
\begin{equation}
\eta = \sum_{i=1}^8 \eta_i \beta_i ,
\end{equation}
and every pure dual quaternion $\theta$ as
\begin{equation}
\theta = \sum_{i=1}^6 \theta_i \beta_i .
\end{equation}

\section{Lie derivatives}

The notion of the Lie derivative, sometimes in our context called the directional derivative, is a combination of two ideas that may be found in the literature.  First is the concept of a Lie derivative with respect to a vector field \cite{wiki1,yano}.  Secondly, the definition of the Lie algebra is that it is the vector space of vector fields that are invariant under left multiplication by elements of the Lie group \cite{lee,wiki2}.  In this way, we can define the Lie derivative of a function with respect to an element of the Lie algebra.  One place in the literature where they are combined is in \cite[equation~(5), Chapter~II]{helgason}.

These standard abstract definitions can be made more concrete in our special case where the Lie group is the set of unit dual quaternions, and the Lie algebra is the set of pure dual quaternions.

If one has a quantity that is a function of pose $g(\eta)$, then we usually think of its derivative as the Jacobian with respect to the components of $\eta$.  But it really makes more sense to compute the derivative with respect to the components of the perturbation of $\eta$.  The latter is the Lie derivative.

The definition is this.  Given a differentiable function $g$ whose domain is the unit dual quaternions, $\setunitdualquat$, we can extend it arbitrarily to a differentiable function whose domain is an open neighborhood of $\setunitdualquat$ in $\setdualquat$.  Given a unit dual quaternion $\eta$ and a pure dual quaternion $\theta$, we define the \emph{Lie derivative} of $g(\eta)$ in the direction of $\theta$ to be
\begin{equation}
\label{lie diff defn}
\liederiv_\theta g = 
\lim_{r\to 0} \frac{g(\eta(1+r \theta)) - g(\eta)} r = 
\left. \frac{d}{d r} g(\eta(1+r\theta)) \right |_{r = 0}.
\end{equation}
Since $\eta(1+r\theta)$ isn't necessarily a unit dual quaternion, it is not obvious that the definition of the directional Lie derivative doesn't depend upon how the domain of $g$ was extended from $\setunitdualquat$, but it is, as is shown in Lemma~\ref{not depend} below.

Given a generic function $g$ whose domain is the dual quaternions, $\setdualquat$, we define its Jacobian to be the dual quaternion
\begin{equation}
\frac{\partial g}{\partial \eta} = \sum_{i=1}^8 \frac{\partial g}{\partial \eta_i} \beta_i.
\end{equation}
If its domain is the pure dual quaternions, $\setpuredualquat$, we have the same formula except with $8$ replaced by $6$.

Using the chain rule for partial derivatives, we obtain the following formula, which is useful for explicitly calculating the Lie derivative if the function $g$ is known.
\begin{equation}
\label{lie diff defn 2}
\liederiv_\theta g = \frac{\partial g}{\partial \eta} \cdot (\eta \theta).
\end{equation}
We define the \emph{partial Lie derivatives} to be
\begin{equation}
\liederiv_i g = \liederiv_{\beta_i} g , \quad (1 \le i \le 6),
\end{equation}
and its \emph{full Lie derivative} to be the pure dual quaternion
\begin{equation}
\liederiv g = \sum_{i=1}^6 \liederiv_i g \beta_i,
\end{equation}
so that for all pure dual quaternions $\theta$ it satisfies:
\begin{equation}
\theta \cdot \liederiv g = \liederiv_\theta g.
\end{equation}

To gain some intuition, write
\begin{equation}
\label{decomp theta}
\theta = \tfrac12\bm a + \tfrac12\epsilon \bm b,
\end{equation}
so that
\begin{equation}
\label{decomp partial theta}
\frac{\partial}{\partial \theta} = 2\frac{\partial}{\partial \bm a} + 2\epsilon \frac{\partial}{\partial \bm b}.
\end{equation}
Then we see that $\theta$ represents a change in pose by an infinitesimal translation $\bm b$ and an infinitesimal rotation $\bm a$, measured in the moving frame of reference.  Thus $\liederiv_\theta g$ is a pure dual quaternion giving twice the change in $g$ with respect to an infinitesimal rotation, plus $\epsilon$ times twice the change of $g$ with respect to an infinitesimal translation.

One important property of the Lie derivative is that if $\eta$ represents a pose, with twist $\varphi$, then
\begin{equation}
\label{dot f Lie phi}
\frac d{dt} [g(\eta)] = \liederiv_\varphi g .
\end{equation}

The Lie derivative satisfies various rules, which are also useful for explicitly calculating the Lie derivative when $g$ is known.
\begin{itemize}
\item If $g(\eta)$ is linear in $\eta$, then
\begin{equation}
\label{rule linear}
\liederiv_\theta g(\eta) = g(\eta \theta).
\end{equation}
\item The product rule: if $\times$ is any product, such as inner product or dual quaternion product, then
\begin{equation}
\liederiv_\theta (g_1 \times g_2) = g_1 \times (\liederiv_\theta g_2) + (\liederiv_\theta g_1) \times g_2.
\end{equation}
\item The chain rule:
\begin{equation}
\liederiv_\theta (h(g_1, g_2,\dots,g_m)) \\ = \sum_{i=1}^m
\frac\partial{\partial g_i} h(g_1, g_2,\dots,g_m) \liederiv_\theta g_i .
\end{equation}
\end{itemize}

\section{Applications to parallel robots}

Suppose that the position of the end effector of a parallel robot is given by $n$ actuators, described by quantities
\begin{equation}
\bm \ell = (\ell_j)_{1 \le j \le n} .
\end{equation}
For example, for a cable-driven parallel robot, these represent the lengths of the cables, and typically $n = 8$.  For the Gough or Stewart Platforms \cite{gallardo-alvarado}, we have $n = 6$.

Let us also denote the force exerted by the actuators by 
\begin{equation}
\bm f = (f_j)_{1 \le j \le n} ,
\end{equation}
defined so that the rate of change of work performed through the actuators is given by
\begin{equation}
\label{dot h f ell}
\frac{d}{dt} \text{(work done)} = \bm f \cdot \dot{\bm\ell} .
\end{equation}

Suppose we have a function $\mathsf L : \setunitdualquat \to \mathbb R^n$, which calculates the required actuator values, $\bm \ell$, from the pose $\eta$ of the moving frame.  This is the \emph{inverse kinematics} function.  If it is a simple cable-driven parallel robot, this can be computed using Pythagoras's Theorem, from the positions of the actuators on the fixed frame, and the positions of where the cables are attached to end effector.  But this formula could be more complicated in other situations.

We also define the $(n \times 6)$ matrix $\mathsf \Lambda$ by
\begin{equation}
\label{Lambda}
\mathsf \Lambda \theta = \liederiv_\theta \mathsf L .
\end{equation}
From equation~\eqref{dot f Lie phi} we obtain
\begin{equation}
\label{dot l Lambda phi}
\dot{\bm \ell} = \mathsf \Lambda \varphi .
\end{equation}

There is also a ($6 \times n$) matrix $\mathsf T$ that maps the actuator forces to the wrench dual quaternion:
\begin{equation}
\label{T}
\tau = \mathsf T \bm f .
\end{equation}
This can be computed by balancing the force and torque exerted upon the end-effector.  But it can also be computed with the following important identity:
\begin{equation}
\label{T=L^T}
\mathsf T = \mathsf \Lambda^T.
\end{equation}
This is because the rate of change of work done on the parallel robot can be computed in two different ways, either using equation~\eqref{dot h tau varphi}, or~\eqref{dot h f ell}.  Substituting in equations~\eqref{dot l Lambda phi} and~\eqref{T}, we obtain
\begin{equation}
\mathsf T \bm f \cdot \varphi.= \bm f \cdot \mathsf \Lambda \varphi.
\end{equation}
Since this is true for arbitrary actuator forces $\bm f$ and end effector twists $\varphi$, the result follows.

\section{Second lie derivatives}

If $g$ is a function of dual quaternions, we define its Hessian to be the $(8 \times 8)$ matrix
\begin{equation}
\left[\frac{\partial^2 g}{\partial \eta^2}\right] = \left[\frac{\partial^2 g}{\partial \eta_i\partial \eta_j}\right] _{ 1 \le i,j \le 8 }.
\end{equation}
Thus the expression $\left[\frac{\partial^2 g}{\partial \eta^2}\right] \gamma$ should be interpreted with $\gamma$ treated as an eight dimensional vector.

We also need to compute second Lie derivatives.  Calculations show that
\begin{equation}
\label{second lie deriv}
\liederiv_\theta \liederiv_\psi g = (\eta \psi) \cdot \left[\frac{\partial^2 g}{\partial \eta^2}\right](\eta \theta) + \frac{\partial g}{\partial \eta} \cdot (\eta \theta \psi) .
\end{equation}
As a corollary, we obtain the well known identity:
\begin{equation}
\label{lie bracket diff = diff lie bracket}
\liederiv_\theta \liederiv_\psi g - \liederiv_\psi \liederiv_\theta g = \liederiv_{(\theta\psi - \psi\theta)} g,
\end{equation}
which implies that Lie derivatives do not necessary commute.

Another way one might try to define the second derivative is to use the formula $\left.\frac {\partial^2}{\partial\theta^2} g(\eta(1+\theta)) \right | _{\theta=0}$.  Unfortunately, this definition doesn't work, as it depends upon the choice of how to extend the domain of $g$ to all dual quaternions.  The obvious choice of extension is to use the normalization:
\begin{equation}
\tilde g(\eta) = g(\hat\eta) .
\end{equation}
We have the following formula for the Hessian of $\tilde g$:
\begin{equation}
\label{hessian}
\left.\frac{\partial^2}{\partial\theta^2} \tilde g(\eta(1+\theta)) \right|_{\theta = 0} = \left[\tfrac12 (\liederiv_i \liederiv_j g(\eta) + \liederiv_j \liederiv_i g(\eta)) \right]_{1\le i,j\le 6}.
\end{equation}
This equation is proved in Section~\ref{sec proofs}.

\section{Forward kinematics for parallel robots}
\label{forward kinematics}

Let the \emph{set of admissible actuator values}, $\mathbb L \subset \mathbb R^n$, be the range of the function $\mathsf L$.  Then the \emph{forward kinematics} function is
\begin{equation}
\mathsf Y : \mathbb L \to \setunitdualquat,
\end{equation}
 which is a left inverse to $\mathsf L$.  Because of possible measurement errors, $\mathsf Y$ should produce decent answers even if the actuator values are merely close to $\mathcal L$.  

We will focus on the over-constrained problem, that is, when the number of actuators $n$ is greater than $6$.  If $n = 6$, a much simpler approach is possible by simply applying the Newton-Raphson method directly to $\mathsf L$.  In that case, only first derivatives of $\mathsf L$ are required.

This problem has been solved by many others, for example, \cite{pott-schmidt,yang-et-al}.  But we feel that this is much more easily solved using dual quaternions.
The function $\mathsf Y$ takes actuator values $\bm\ell = (\ell_1,\dots,\ell_n)$, and seeks to find the pose $\eta$ so that $\mathsf L(\eta)$ is close as possible to $\bm\ell$.  We do this by seeking to minimize the \emph{loss function}
\begin{equation}
b(\eta) = \tfrac12 {|\mathsf L(\eta) - \bm\ell|}^2
\end{equation}
We use the Newton-Raphson Method, which given $\eta_k$ close to a minimum of the loss function, finds $\eta_{k+1}$ which is much closer to the same minimum of the loss function.  Because this method as usually stated works only on linear vector spaces, we first have to define a map $\theta\mapsto\tilde b_k(\theta)$, with $\tilde b_k(0) = \eta_k$, from the linear vector space of pure dual quaternions to the manifold of unit dual quaternions \cite{huper-trumpf}.

Most papers on the Newton-Raphson Method on manifolds construct this map using the so called exp function \cite{dedieu-et-al,fernandes-et-al,ferreira-svaiter}.  So the map is
\begin{equation}
\tilde b_k(\theta) = b(\eta_k \exp(\theta)).
\end{equation}
The exp map in these papers is following the path of a geodesic on the manifold, and this is equivalent to using the equations of motion of the end effector as described in Section~\ref{dynamics}.  Another exp map is to follow a one-parameter subgroup, or equivalently, equation~\eqref{exponential}.  We do not take these approaches, as they can be computationally expensive.  Our approach is to normalize:
\begin{equation}
\tilde b_k(\theta) = b(\eta_k  \widehat{(1 + \theta)}).
\end{equation}
This is numerically close to the second approach, as is shown by equation~\eqref{exp-normal}.

In order to apply the Newton-Raphson, we need to compute the Jacobian
\begin{equation}
\label{jacobian}
\delta_k = \left.\frac{\partial\tilde b_k}{\partial\theta} \right|_{\theta = 0} = (\liederiv_i b(\eta_k))_{1 \le i \le 6},
\end{equation}
and its Hessian $\mathsf H_k$, which by equation~\eqref{hessian} is
\begin{equation}
\mathsf H_k
= \left[\tfrac12 (\liederiv_i \liederiv_j b(\eta_k) + \liederiv_j \liederiv_i b(\eta_k)) \right]_{1\le i,j\le 6}.
\end{equation}

The Newton-Raphson method we use is to iterate:
\begin{equation}
\eta_{k+1} = \eta_k \widehat{(1 - \mathsf H_k^{-1} \delta_k)} .
\end{equation}

For the criterion of when to terminate the Newton-Raphson Method, we measure $\|\eta_{k+1} - \eta_k\|$.

This method works well in practice, because typically we measure the pose frequently, and thus the current pose won't be much different than the previously measured pose.  Thus the previously measured pose is a good starting value for using the Newton-Raphson method for finding the current pose.  We found that only about two or three iterations of the Newton-Raphson method were generally required, and that it easily ran at a thousand times per second on a modern computer.

\section{Dynamics of the end effector}
\label{dynamics}

We define the \emph{no-load forces} to be the actuator forces if there is no end effector present:
\begin{equation}
\bm f_0 = \mathsf M_0 \ddot{\bm \ell},
\end{equation}
where $\mathsf M_0$ is a positive definite $(n\times n)$ matrix denoting what we shall call the \emph{effective no-load mass of the actuators}.

Let us suppose that the kinetic energy of the parallel robot is given by
\begin{equation}
\label{ke}
e = \tfrac12 \varphi \cdot \mathsf M \varphi,
\end{equation}
where $\mathsf M$ is a $(6 \times 6)$ positive definite matrix, which depends only upon $\eta$, and which we call the \emph{effective mass of the parallel robot}.  If $m_e$ is the mass of the end effector, $\mathsf M_e$ is the moment of inertia tensor of the end effector about its center of mass, and $\bm r_0$ is the center of mass of the end effectors, all measured with respect to the moving frame, then
\begin{equation}
e = \tfrac12 m_e |\bm v + \bm w \times \bm r_0|^2 + \tfrac12 \bm w \cdot \mathsf M_e \bm w + \tfrac12 \dot{\bm\ell} \cdot \mathsf M_0 \dot{\bm\ell} , 
\end{equation}
that is
\begin{equation}
\label{M example}
\mathsf M = 4 \begin{bmatrix} \mathsf M_e - m_e (\starop{\bm r_0})^2 & m_e \starop{\bm r_0} \\ - m_e (\starop{\bm r_0}) & m_e \mathsf I \end{bmatrix} + \mathsf\Lambda^T \mathsf M_0 \mathsf\Lambda,
\end{equation}
where $\mathsf I$ is the $(3 \times 3)$ identity matrix.

The next result is proved in Section~\ref{sec proofs}.

\begin{theorem}
\label{equation of motion}
If the kinetic energy satisfies equation~\eqref{ke} with equation~\eqref{M example} holding, and the potential energy $v$ is calculated in the usual manner from the mass of the end effector in a constant gravitational field $\bm g$, then the equation of motion is
\begin{equation}
\tau = \mu + \mathsf M \alpha,
\end{equation}
where
\begin{multline}
\label{tau example}
\mu = 2\bm w \times (\mathsf M_e \bm w) + 2\epsilon m_e \bm w \times \bm v \\
+ 2 m_e ((\bm w \cdot \bm r_0) (\bm w \times \bm r_0) + \bm r_0 \times (\bm w \times \bm v) + \epsilon \bm w \times (\bm w \times \bm r_0)) \\
+ \mathsf \Lambda^T \mathsf M_0 (\liederiv_\varphi \mathsf \Lambda) \varphi 
- 2 m_e (\bm r_0 \times \tilde{\bm g} + \epsilon \tilde{\bm g}) ,
\end{multline}
with
\begin{equation}
\tilde{\bm g} = \overline Q \bm g Q ,
\end{equation}
and
\begin{equation}
\mathsf M \alpha = 2 \mathsf M_e \dot{\bm w} + 2 m_e (\bm r_0 \times \dot{\bm v}) + 2 \epsilon m_e \dot{\bm v} + \mathsf\Lambda^T \mathsf M_0 \mathsf \Lambda \alpha.
\end{equation}
\end{theorem}

The various terms in equation~\eqref{tau example} can be interpreted as follows.
\begin{itemize}
\item $\mathsf M_e \dot{\bm w}$ and $m_e \dot{\bm v}$ are inertial resistance to change of angular and translational velocities.
\item $m_e \bm w \times \bm v$ is the centripetal force required to rotate and move at the same time.
\item $\bm w \times (\mathsf M_e \bm w)$ is the precession torque (so that if the moment of inertia is not isotropic, then the body spins in a counter-intuitive manner, see, for example, \cite{kawano-et-al}).
\item
\begin{equation}
\mathsf \Lambda^T \mathsf M_0 (\liederiv_\varphi \mathsf \Lambda) \varphi + \mathsf\Lambda^T \mathsf M_0 \mathsf \Lambda \alpha = \mathsf T \bm f_0
\end{equation}
is the wrench required to move the actuators, where the no-load forces may be computed using
\begin{equation}
\bm f_0 = \mathsf M_0 \liederiv_\varphi(\mathsf\Lambda \varphi) + \mathsf M_0 \mathsf\Lambda \alpha .
\end{equation}
\item $m_e \tilde{\bm g}$ is the force due to gravity, translated into the moving frame of reference.
\item All terms containing $\bm r_0$ are corrections required since the center of gravity isn't necessarily the same as the origin of the moving frame of reference.  They could be derived by first finding the equations of motion when $\bm r_0 = 0$, and then applying equations~\eqref{twist correction} and~\eqref{torque correction}.
\end{itemize}

\section{Spherical linear interpolation of dual quaternions}
\label{sec fun dq}

Suppose we are given two unit dual quaternions, $\eta_1$ and $\eta_2$?  The problem is to find the dual quaternion valued function of time, denoted $\text{slerp}(\eta_1, \eta_2, t)$, such that at $t = 0$, it takes the value $\eta_1$, that at $t = 1$, it takes the value $\eta_2$, and such that its twist, $\theta$, is a constant pure dual quaternion.  The name of the function, `slerp', comes from the equivalent problem for orientations \cite{shoemake}.

This requires two functions.  The first is the exponential function, defined in equation~\eqref{exponential}.  The function $\exp(t \theta)$ as function of time $t$ is the pose traveled if it is the identity pose at $t = 0$, and maintains a constant twist $\theta$.  The second is a logarithm function, which given a unit dual quaternion $\eta$, finds $\theta$ such that $\exp(\theta) = \eta$.  There are infinitely many possibilities for $\theta$, so we will just describe the principal value, that is, the one for which the norm of the angular velocity is minimized.  Then
\begin{equation}
\begin{aligned}
\text{slerp}(\eta_1, \eta_2, t) &= \eta_1 \exp(t \log(\overline\eta_1 \eta_2)) \\
&= \exp(t \log(\eta_2 \overline\eta_1)) \eta_1 .
\end{aligned}
\end{equation}
If one is merely interested in interpolating between the poses represented by these unit dual quaternions, multiply one of them by $\pm 1$ so that non-dual part of $\eta_1 \eta_2^{-1}$ has non-negative real part.

The results of this section may be found in \cite{montgomery-smith}.  We have seen similar results in \cite{wang-et-al}, but we believe our formulas to be more explicit.

Given any dual quaternion
\begin{equation}
\eta = c + \bm d + \epsilon (x + \bm y),
\end{equation}
by decomposing $\bm y$ into a vector parallel to $\bm d$ and perpendicular to $\bm d$, we can suppose without loss of generality that there exists orthonormal vectors $\bm a$ and $\bm b$ such that $\eta$ is a linear combination of $1$, $\bm a$, $\epsilon$, $\bm a \epsilon$, and $\bm b \epsilon$.

\begin{theorem}
\label{exp dq}
If $\bm a$ and $\bm b$ are orthonormal vectors, then if $w \ne 0$
\label{exp theta}
\begin{equation}
\begin{aligned}
& \exp\left(\tfrac12wt \bm a + (\tfrac12v_1t \bm a + \tfrac12v_2t \bm b) \epsilon\right) \\
&= \left(\cos(\tfrac12wt) + \sin(\tfrac12wt) \bm a\right) \left(1 + \tfrac12 v_1t \bm a \epsilon\right) \\
&\phantom{{}={}} + \frac {v_2}w\sin(\tfrac12 wt) \bm b \epsilon ,
\end{aligned}
\end{equation}
and if $w = 0$
\begin{equation}
\exp\left(\tfrac12 vt \bm a \epsilon\right) = 1 + \tfrac12 v t \bm a \epsilon .
\end{equation}
\end{theorem}
If $w \ne 0$, this represents a pose that rotates counterclockwise with angular velocity $w$ around $\bm a$, and translates by
\begin{equation*}
v_1 t \bm a + \frac {v_2}w\bigl(\sin(wt)  \bm b + (1-\cos(wt)) (\bm a \times \bm b) \bigr) ,
\end{equation*}
that is, the sum of a point on a line in the direction of $\bm a$ moving with speed $v_1$, and a point on a circle in the plane perpendicular to $\bm a$ of radius $v_2/w$ which is traversed once every $2\pi/w$ time units.  If $w = 0$, this represents a pose with the identity rotation and translating in a straight line with velocity $v$.

\begin{theorem}
\label{log dq}
Suppose $\bm a$ and $\bm b$ are orthonormal vectors, and that
\begin{equation}
\label{eta for log}
\eta = c + s \bm a + \epsilon (x + y_1 \bm a + y_2 \bm b)
\end{equation}
is a unit dual quaternion, with $c \ne -1$.  Let
\begin{equation}
t = \text{\rm atan2}(s,c),
\end{equation}
that is, the angle part of the polar coordinates of $(c,s)$, with $|t| < \pi$.  Then if $t \ne \pi$ then
\begin{equation}
\log(\eta) = t \bm a + \epsilon (c y_1 - s x ) \bm a
+ \epsilon \frac{t y_2}{s} \bm b,
\end{equation}
where if $s = 0$ we assume $y_0 = 0$, and we set $y_2/s = 0$.
\end{theorem}

It is not possible to assign a canonical principal value for $\log(-1)$, because it could be $\pi \bm a$ for any unit vector $\bm a$.

\section{Proofs}
\label{sec proofs}

\begin{proof}[Proof of Equation~\eqref{approx normalize}]  Since $\overline\theta = -\theta$, we have
\begin{equation}
|1+\theta|^2 = 1 - \theta^2.
\end{equation}
Hence using Taylor's series
\begin{equation}
|1+\theta|^{-1} = 1 + \tfrac12 \theta^2 + O(\theta^3)
\end{equation}
from which it follows that
\begin{equation}
\widehat{(1+\theta)} = (1+\theta)(1+\theta)^{-1} = 1 + \theta + \tfrac12 \theta^2 + O(\theta^3)  .
\end{equation}
\end{proof}

\begin{proof}[Proof of Equation~\eqref{twist as dual quaternion}]
First, if we differentiate $\overline\eta \eta = 1$, we obtain $\varphi + \overline \varphi = 0$, that is, $\varphi$ is pure.

Suppose the position $\bm s$ is the image of the constant position $\bm r$ under the pose represented by $(\mathsf R, \bm t)$ and also represented by $\eta = Q + \epsilon B$.  Differentiating equation~\eqref{pose action} we obtain
\begin{equation}
\label{dot s 1}
\dot{\bm s} = \mathsf R \starop{\bm w} \bm r + \mathsf R \bm v = \mathsf R(\bm w \times \bm r + \bm v ).
\end{equation}
Differentiating equation~\eqref{defn of pose on 3-vector} we obtain
\begin{equation}
\epsilon \dot{\bm s}
= \frac d{dt}\bigl(\eta(1+\epsilon \bm r)\overline \eta^*\bigr)
= \eta\bigl(\varphi(1+\epsilon \bm r) + (1+\epsilon\bm r)\overline{\varphi}^*\bigr)\overline \eta^* .
\end{equation}
After some manipulation, and setting $\varphi = \tfrac12\bm a + \tfrac12\epsilon \bm b$, we obtain
\begin{equation}
\label{dot s 2}
\dot{\bm s} = Q(\bm a \times \bm r + \bm b)\overline Q .
\end{equation}
Comparing equations~\eqref{dot s 1} and~\eqref{dot s 2}, we obtain
\begin{equation}
\bm w \times \bm r + \bm v = \bm a \times \bm r + \bm b,
\end{equation}
and since this holds for all $\bm r$, the result follows.
\end{proof}

\begin{lemma}
\label{not depend}
The definition of $\liederiv_\theta g$ in equation~\eqref{lie diff defn} does not depend upon the extension of $g$ from $\setunitdualquat$ to a neighborhood of $\setunitdualquat$ in $\setdualquat$.
\end{lemma}

\begin{proof}  Let $g_1$ and $g_2$ be two extensions of $g$ from $\setunitdualquat$ to a neighborhood of $\setunitdualquat$ in $\setdualquat$.  Define
\begin{equation}
\tilde g(\eta) = g_1(\widehat\eta) = g_2(\widehat\eta).
\end{equation}
Then
\begin{equation}
\begin{aligned}
\left.\frac{d}{d r} \tilde g(\eta(1+r\theta)) \right |_{r = 0}
&=
\left.\frac{d}{d r} g_1(\eta\widehat{(1+r\theta)}) \right |_{r = 0} \\
&=\left.\frac{d}{d r} g_1(\eta(1+r\theta)) \right |_{r = 0},
\end{aligned}
\end{equation}
where the second equality follows from equation~\eqref{approx normalize}.  Similarly for $g_2$.
\end{proof}

\begin{proof}[Proof of Equation~\eqref{hessian}]
We wish to find the Jacobian $\delta$ and the Hessian $\mathsf H$ of $\tilde b$ at the origin, where
\begin{equation}
\tilde b(\theta) = b(\eta  \widehat{(1 + \theta)}).
\end{equation}
We can find this by considering its Taylor series expansion
\begin{equation}
\tilde b(\theta) = \tilde b(0) + \sum_{i=1}^6 \delta_{i} \theta_i + \tfrac12 \sum_{i,j=1}^6 \mathsf H_{i,j} \theta_i \theta_j + O(\theta^3),
\end{equation}
where
\begin{equation}
\theta = \sum_{i=1}^6 \theta_i \beta_i.
\end{equation}
Using the Taylor series, and using equation~\eqref{approx normalize}, one obtains
\begin{equation}
\begin{aligned}
&\tilde b(\theta) = b(\eta  \widehat{(1 + \theta)})
= b(\eta(1 + \theta + \tfrac12 \theta^2 + O(\theta^3))) \\
&= b(\eta) + \frac{\partial b}{\partial \eta} \cdot(\eta(\theta + \tfrac12 \theta^2)) \\
&\phantom{{}={}} + \tfrac12 (\eta \theta) \cdot \left[\frac{\partial^2 b}{\partial \eta^2}\right] (\eta\theta)
+ O(\theta^2) \\
&= b(\eta) + \frac{\partial b}{\partial \eta} \cdot(\eta(\theta)) \\
&\phantom{{}={}} + \tfrac12 (\eta \theta) \cdot \left[\frac{\partial^2 b}{\partial \eta^2}\right] (\eta\theta) + \frac{\partial b}{\partial \eta} \cdot(\tfrac12 \eta \theta^2) + O(\theta^3) .
\end{aligned}
\end{equation}
Now by comparing coefficients, and considering equations~\eqref{lie diff defn 2} and~\eqref{second lie deriv}, we obtain
\begin{equation}
\delta_i = \liederiv_i b(\eta), \quad (1 \le i \le 6),
\end{equation}
and
\begin{equation}
\begin{aligned}
\mathsf H_{i,j} &=
(\eta \beta_i) \cdot \left[\frac{\partial^2 b}{\partial \eta^2}\right] (\eta\beta_j) + \frac{\partial b}{\partial \eta} \cdot(\tfrac12 \eta(\beta_i\beta_j+\beta_j\beta_i)) \\
&= \tfrac12 (\liederiv_i \liederiv_j b(\eta) + \liederiv_j \liederiv_i b(\eta)),
\quad (1\le i,j\le 6).
\end{aligned}
\end{equation}
\end{proof}

\bigskip

Now we work on proving Theorem~\ref{equation of motion}.  We use the Euler-Lagrange equations.  However, some may consider it easier to use standard formulas for rotating bodies, and Newtonian physics, to obtain the same result.

Define the \emph{cross product} of two pure dual quaternions $\alpha = \bm a + \epsilon \bm b$ and $\beta = \bm c + \epsilon \bm d$ by
\begin{equation}
\alpha \times \beta = \tfrac12(\alpha \beta - \beta \alpha) = \bm a \times \bm c + \epsilon (\bm a \times \bm d + \bm b \times \bm c) .
\end{equation}
Define the \emph{adjoint products} of pure dual quaternions by
\begin{align}
\label{ltimes}
\alpha \ltimes \beta &= \bm c \times \bm a + \bm d \times \bm b + \epsilon (\bm c \times \bm b) ,\\
\alpha \rtimes \beta &= - \beta \ltimes \alpha ,
\end{align}
which can also be defined by the property that for all pure dual quaternions $\alpha$, $\beta$, and $\gamma$ we have
\begin{equation}
(\alpha \times \beta) \cdot \gamma = \alpha \cdot (\gamma \ltimes \beta) = \beta \cdot (\alpha \rtimes \gamma ).
\end{equation}

%Note that if $f$ is a linear function from the pure dual quaternions to the scalars, then there is a unique pure dual quaternion $\mu$ such that for every pure dual quaternion $\psi$ we have
%\begin{equation}
%\label{duality defn}
%\psi \cdot \mu = f(\psi) .
%\end{equation}
%To see this, apply this formula to $\psi = \beta_k$ for $1 \le k \le 6$, and obtain
%\begin{equation}
%\mu_k = f(\beta_k) .
%\end{equation}

\begin{theorem}
\label{euler-lagrange}
If the kinetic energy $e$ satisfies equation~\eqref{ke}, and $v = v(\eta)$ denotes the potential energy, then the equation of motion is
\begin{equation}
\label{tau M gamma}
\tau = \mu_1 + \mu_2 + \mathsf M \alpha,
\end{equation}
where
\begin{equation}
\mu_1 = \liederiv_\varphi \mathsf M \varphi - \tfrac12 \liederiv(\varphi \cdot \mathsf M \varphi) + \liederiv v, 
\end{equation}
and for any constant pure dual quaternion $\psi$ we have
\begin{equation}
\psi \cdot \mu_2 = 2 \varphi \cdot \mathsf M (\psi \times \varphi),
\end{equation}
that is,
\begin{equation}
\label{formula mu_2}
\mu_2 = 2 (\mathsf M \varphi) \ltimes \varphi .
\end{equation}
\end{theorem}

\begin{proof}  In preparation to apply the Euler-Lagrange Equation, given $\eta_0 \in \setunitdualquat$, we define a map from an open neighborhood of the origin in $\mathbb R^6$ to an open neighborhood of $\eta_0$ in $\setunitdualquat$
\begin{equation}
\label{eta(theta)}
\begin{aligned}
\theta &\mapsto \eta(\theta) \\
&= \eta_0 \widehat{(1+\theta)} \\
&= \eta_0 (1 + \theta + \tfrac12 \theta^2) + O(\theta^3),
\end{aligned}
\end{equation}
where in the last inequality we used equation~\eqref{approx normalize}.  Then we have
\begin{equation}
\label{dot theta}
\begin{aligned}
\varphi &= \eta^{-1} \dot\eta \\
&= \widehat{(1+\theta)}^{-1} (\dot \theta + \tfrac12(\dot\theta\theta + \theta\dot\theta)) + O(\theta^2) \\
&= \dot\theta + \tfrac12(\dot\theta\theta - \theta\dot\theta) + O(\theta^2) ,
\end{aligned}
\end{equation}
and
\begin{equation}
\label{ddot theta}
\alpha = \ddot\theta + O(\theta) .
\end{equation}
The Lagrangian of the parallel robot is
\begin{equation}
l = e - v = \tfrac12 \varphi \cdot \mathsf M \varphi - v.
\end{equation}
We use the local coordinate system $\theta$ given by equation~\eqref{eta(theta)}.  The Euler-Lagrange Equation \cite{arnold,goldstein-et-al} tells us
\begin{equation}
\label{e-l}
\frac d{dt}\left(\frac{\partial l}{\partial \dot\theta}\right) - \frac{\partial l}{\partial \theta} = \tau.
\end{equation}
We suppose that $\eta_0 = \eta(t_0)$, and $\theta(t_0) = 0$, and from now on in this proof, all equations are stated assuming the condition $t = t_0$.  Thus we only prove our results when $t = t_0$.  But since $t_0$ is arbitrary, this is not a limitation.  However, it is important that derivatives are calculated before setting $t = t_0$.  In particular, this means that for any function $f$ of $\eta$ that
\begin{equation}
\frac{\partial f}{\partial \theta} = \liederiv f.
\end{equation}

We have
\begin{equation}
\begin{aligned}
\frac d{dt}\left(\frac{\partial e}{\partial \dot\theta}\right)
&= \mathsf M\alpha + \dot{\mathsf M} \varphi \\
&= \mathsf M\alpha + \left(\dot\theta \cdot \frac{\partial \mathsf M}{\partial\theta}\right) \dot\theta \\
& = \mathsf M\alpha + \left(\varphi \cdot \frac{\partial \mathsf M}{\partial\theta}\right) \varphi,
\end{aligned}
\end{equation}
and
\begin{equation}
\label{de/dtheta}
\begin{aligned}
\frac{\partial e}{\partial \theta}
&= \dot \theta \cdot \mathsf M \frac{\partial}{\partial\theta}(\dot\theta \theta - \theta \dot\theta) + \tfrac12 \dot\theta \cdot \left(\frac{\partial \mathsf M}{\partial\theta}\right) \dot\theta \\
&= \varphi \cdot \mathsf M \frac{\partial}{\partial\theta}(\varphi \theta - \theta \varphi) + \tfrac12 \varphi \cdot \left(\frac{\partial \mathsf M}{\partial\theta}\right) \varphi .
\end{aligned}
\end{equation}
Note that if $f$ is any linear function whose domain is the pure dual quaternions, then
\begin{equation}
\psi \cdot \left(\frac{\partial}{\partial \theta} f(\theta)\right) = f(\psi) .
\end{equation}
Thus taking the dot product of equation~\eqref{de/dtheta} with any constant pure dual quaternion $\psi$, we obtain the result.
%To obtain equation~\eqref{formula mu_2}, see that
%\begin{equation}
%\begin{aligned}
%\psi \cdot \mu_2
%&= \varphi \cdot \mathsf M (\psi\varphi - \varphi\psi) \\
%&= (\mathsf M\varphi) \cdot (\psi\varphi - \varphi\psi) \\
%&= \psi \cdot ((\mathsf M\varphi) \ltimes \varphi - \varphi \rtimes (\mathsf M\varphi)) \\
%&= 2 \psi \cdot ((\mathsf M\varphi) \ltimes \varphi)) .
%\end{aligned}
%\end{equation}
\end{proof}

%From equation~\eqref{ltimes} we immediately obtain the following.

%\begin{lemma}
%\label{post euler-lagrange}
%Under the hypotheses of Theorem~\ref{euler-lagrange}, if we have
%\begin{equation}
%\label{M general}
%\mathsf M = 4 \begin{bmatrix} \mathsf M_{11} & \mathsf M_{12} \\ \mathsf M_{12}^T & \mathsf M_{22} \end{bmatrix},
%\end{equation}
%then
%\begin{equation}
%\begin{aligned}
%\mu_2 &=
%2\bm w \times (\mathsf M_{11} \bm w + \mathsf M_{12} \bm v) \\
%&\phantom{{}={}} + 2 (\bm v + \epsilon \bm w) \times (\mathsf M_{12}^T \bm w + \mathsf M_{22} \bm v) .
%\end{aligned}
%\end{equation}
%\end{lemma}

\begin{lemma}
\label{lambda pot energy}
If $v$ is the potential energy of the end effector in a constant gravity field $\bm g$, then
\begin{equation}
\liederiv v = - 2 m_0 (\bm r_0 \times \tilde{\bm g} + \epsilon \tilde{\bm g}) ,
\end{equation}
where
\begin{equation}
\tilde{\bm g} = \overline Q \bm g Q .
\end{equation}
\end{lemma}

\begin{proof}  By equation~\eqref{pose on 3-vector}, the position of the end effector's center of mass in the stationary frame of reference is
\begin{equation}
\bm h = Q \bm r_0 \overline Q + 2 B\overline Q,
\end{equation}
where the pose is $\eta = Q + \epsilon B$.  Hence the potential energy is
\begin{equation}
v (\eta) = - m_0 \bm g \cdot \bm h .
\end{equation}
Thus the result follows if for any constant pure dual quaternion $\psi = \tfrac12\bm a + \tfrac12 \epsilon \bm b$, we have
\begin{equation}
\liederiv_\psi (\bm g \cdot \bm h)
= 2 \psi \cdot (\bm r_0 \times \tilde{\bm g} + \epsilon \tilde{\bm g}) .
\end{equation}
To see this, first note that
\begin{equation}
\eta \psi = \tfrac12 Q \bm a + \tfrac12 (B \bm a + Q \bm b) ,
\end{equation}
from which it follows by equation~\eqref{rule linear} that
\begin{gather}
\liederiv_\psi Q = \tfrac12 Q \bm a \\
\liederiv_\psi B = \tfrac12 (B \bm a + Q \bm b) .
\end{gather}
Since $\overline{\bm a} = -\bm a$, and $\overline{\bm b} = - \bm b$, we have
\begin{equation}
\begin{aligned}
\liederiv_\psi \bm h &= 
\tfrac12(
Q \bm a \bm r_0 \overline Q - Q \bm r_0 \bm a \overline Q + 2 B \bm a \overline Q + 2 Q \bm b \overline Q - 2 B \bm a \overline Q ) \\
&= Q(\bm a \times \bm r_0)\overline Q + Q \bm b \overline Q .
\end{aligned}
\end{equation}
Noting that for any three quaternions $A$, $B$, and $C$, we have
\begin{equation}
(AB)\cdot C = \realpart(C (\overline{AB})= A \cdot (C \overline B) = B \cdot (\overline A C),
\end{equation}
we obtain that
\begin{equation}
\liederiv_\psi (\bm g \cdot \bm h) = \tilde{\bm g} \cdot (\bm a \times \bm r_0 + \bm b) = 2 \psi \cdot (\bm r_0 \times \tilde{\bm g} + \epsilon \tilde{\bm g}) .
\end{equation}
\end{proof}

\begin{proof}[Proof of Theorem~\ref{equation of motion}] The potential energy part is covered by Lemma~\ref{lambda pot energy}.  For the parts coming from the kinetic energy, using linearity, it is sufficient to prove it for the additive parts of $\mathsf M$.  The part not involving $m_0$ is proved using Theorem~\ref{euler-lagrange}, various vector identities, and remembering equation~\eqref{w star to w cross}.

So we only need to prove the kinetic energy portion in the case $\mathsf M = \mathsf \Lambda^T \mathsf M_0 \mathsf \Lambda$.  The easiest way to show this is to simply differentiate $\mathsf M_0 \dot \ell = \mathsf M_0 \mathsf\Lambda\varphi$ with respect to time.  To do it directly from the formulas is more complicated, as we now show.  For any constant pure dual quaternion $\psi$, we have
\begin{equation}
\begin{aligned}
\psi &\cdot (\liederiv_\varphi(\mathsf M \varphi) - \tfrac12 \liederiv(\varphi \cdot \mathsf M \varphi)) \\
&= (\liederiv_\varphi(\psi \cdot \mathsf M \varphi) - \tfrac12 \liederiv(\varphi \cdot \mathsf M \varphi)) \\
&= \liederiv_\varphi ((\mathsf \Lambda \psi) \cdot \mathsf M_0 (\mathsf \Lambda \varphi))
- \tfrac12 \liederiv_\psi  ((\mathsf \Lambda \varphi) \cdot \mathsf M_0(\mathsf \Lambda \varphi)) \\
&= \liederiv_\varphi \liederiv_\varphi \mathsf L \cdot \mathsf M_0 \liederiv_\psi \mathsf L
+ \liederiv_\varphi \liederiv_\psi \mathsf L \cdot \mathsf M_0\liederiv_\varphi \mathsf L - \liederiv_\psi \liederiv_\varphi \mathsf L \cdot \mathsf M_0\liederiv_\varphi \mathsf L \\
&= \liederiv_\varphi (\mathsf\Lambda \varphi) \cdot \mathsf M_0\mathsf\Lambda \psi
+ \liederiv_{(\varphi \psi - \psi \varphi)} \mathsf L \cdot \mathsf M_0\mathsf\Lambda \varphi \\
&= \psi \cdot \mathsf\Lambda^T \mathsf M_0 \liederiv_\varphi (\mathsf \Lambda \varphi)
+ \mathsf \Lambda (\varphi\psi - \psi\varphi) \cdot \mathsf M_0 \mathsf \Lambda \varphi
\\
&= \psi \cdot \mathsf\Lambda^T \mathsf M_0\liederiv_\varphi (\mathsf \Lambda \varphi)
+ (\varphi\psi - \psi\varphi) \cdot \mathsf M_0 \varphi,
\end{aligned}
\end{equation}
where we used equation~\eqref{lie bracket diff = diff lie bracket}.  Then it is simply a matter of collecting terms.
\end{proof}

\section{Projection from matrices to orthogonal matrices}
\label{sec final note}

What would be a good projection of $(3 \times 3)$ matrices onto rotation matrices?  One suggestion is $\mathsf A \mapsto \widehat{\mathsf A} = (\mathsf A\mathsf A^T)^{-1/2} \mathsf A = \mathsf A (\mathsf A^T \mathsf A)^{-1/2}$, which works if we have $\det(\mathsf A) > 0$.  One way to compute it is via the singular value decomposition $\mathsf A = \mathsf U \mathsf \Sigma \mathsf V^T$, when $\widehat{\mathsf A} = \mathsf U\mathsf V^T$.  However this is computationally expensive.  See \cite{higham}.

\section{Conclusion}

There are many papers advocating for the use of dual quaternions in robotics \cite{adorno,han-et-al,wang-et-al}.  But this paper contains formulas we have not seen elsewhere, namely equation~\eqref{inverse unit} which simplifies the comuptation of the inverse of a unit dual quaternion, equation~\eqref{approx normalize} which gives a second order expansion of the normalization of dual quaternions close to $1$, Theorem~\ref{euler-lagrange} which gives dynamics of the end effector in the language of dual quaternions as well as including the effects of driving the actuators, and Theorems~\ref{exp dq} and ~\ref{log dq} which show how to evaluate a exponential and logarithm of a dual quaternion.  We also haven't seen Lie derivatives discussed in the context of dual quaternions and robotics, nor the Newton-Raphson Method to solve for unit dual quaternions.  We also feel that the use of dual quaternions to represent twists, as in equations~\eqref{ode dual quaternion} and~\eqref{twist as dual quaternion}, hasn't received enough emphasis.

\begin{thebibliography}{99}

\bibitem{adorno} Bruno Vilhena Adorno, Robot Kinematic Modeling and Control Based on Dual Quaternion Algebra -- Part I: Fundamentals, 2017, hal-01478225.

\bibitem{quaternions1} S.L. Altmann, Hamilton, Rodrigues, and the Quaternion Scandal, Mathematics Magazine, Vol. 62, No. 5. (Dec., 1989), pp. 291-308.

\bibitem{arnold} V.I. Arnold, Mathematical Methods of Classical Mechanics, 2nd Ed, Springer-Verlag, 1989.

\bibitem{ball} R.S. Ball, The theory of screws: A study in the dynamics of a rigid body. Hodges, Foster and Co., Dublin, 1876.

\bibitem{bottema-et-al} O. Bottema, B. Roth, Theoretical Kinematics, North-Holland, Amsterdam, 1979.

\bibitem{clifford} M.A. Clifford, Preliminary Sketch of Biquaternions, Proceedings of the London Mathematical Society, Volume s1-4, Issue 1, November 1871, Pages 381-395, \url{https://doi.org/10.1112/plms/s1-4.1.381}.

\bibitem{dedieu-et-al} Jean-Pierre Dedieu, Pierre Priouret, Gregorio Malajovich, Newton’s Method on Riemannian Manifolds: Covariant Alpha-Theory, 395-419, IMA Journal of Numerical Analysis Volume: 23, Issue: 3, July 2003 DOI: 10.1093/imanum/23.3.395.

\bibitem{fernandes-et-al} Teles A. Fernandes, Orizon P. Ferreira and Jinyun Yuan, On the Superlinear Convergence of Newton’s Method on Riemannian Manifolds, Journal of Optimization Theory and Applications, 173, 828-843 (2017).

\bibitem{ferreira-svaiter} O.P. Ferreira and B.F. Svaiter, Kantorovich's Theorem on Newton's Method in Riemannian Manifolds, Journal of complexity 18, 304-329 (2002), doi:10.1006-jcom.2001.0582.

\bibitem{gallardo-alvarado} Jaime Gallardo-Alvarado, Kinematic Analysis of Parallel Manipulators by Algebraic Screw Theory, Springer, Switzerland, 2016.

\bibitem{goldstein-et-al} Herbert Goldstein, C.P. Poole, J.L. Safko, (2001), Classical Mechanics (3rd ed.). Addison-Wesley.

\bibitem{han-et-al} Da-Peng Han, Qing Wei, and Ze-Xiang Li, Kinematic Control of Free Rigid Bodies Using Dual Quaternions, International Journal of Automation and Computing
05(3), July 2008, 319-324, DOI: 10.1007/s11633-008-0319-1.

\bibitem{helgason} Sigurdur Helgason, Differential Geometry, Lie Groups and Symmetric Spaces, 656 pp. Academic Press, New York, 1978.

\bibitem{higham} N.J. Higham, Matrix nearness problems and applications, in M.J.C. Gover and S. Barnett, editors, Applications of Matrix Theory, pages 1-27. Oxford University Press, 1989.

\bibitem{huper-trumpf} K. Huper and J. Trumpf, Newton-like methods for numerical optimization on manifolds, Conference Record of the Thirty-Eighth Asilomar Conference on Signals, Systems and Computers, 2004., Pacific Grove, CA, USA, 2004, 136-139 Vol 1, doi: 10.1109/ACSSC.2004.1399106.

\bibitem{kavan-et-al} L. Kavan, S. Collins, J. \u Z\'ara, C. O'Sullivan, Skinning with Dual Quaternions, \url{https://dl.acm.org/doi/pdf/10.1145/1230100.1230107}.

\bibitem{kavan-et-al-2} L. Kavan, S. Collins, J. \u Z\'ara, C. O'Sullivan, Geometric Skinning with Approximate Dual Quaternion Blending, ACM Transactions on Graphics, Vol. 27, No. 4, Article 105, Publication date: October 2008.

\bibitem{kawano-et-al} Daniel T. Kawano, Alyssa Novelia and Oliver M. O'Reilly, A tumbling T-handle in space: the Dzhanibekov effect, \url{https://rotations.berkeley.edu/a-tumbling-t-handle-in-space}.

\bibitem{kenwright} Ben Kenwright, A Beginners Guide to Dual-Quaternions, What They Are, How They Work, and How to Use Them for 3D Character Hierarchies, \url{https://cs.gmu.edu/~jmlien/teaching/cs451/uploads/Main/dual-quaternion.pdf}.

\bibitem{lee} John Lee, Introduction to Smooth Manifolds. Graduate Texts in Mathematics. 218 (Second ed.). New York London: Springer-Verlag. ISBN 978-1-4419-9981-8. OCLC 808682771, 2012.

\bibitem{montgomery-smith} Stephen Montgomery-Smith, Functional Calculus for dual quaternions, arXiv:2202.04681, \url{https://arxiv.org/abs/2202.04681}.

\bibitem{pott-schmidt} Andreas Pott and Valentin Schmidt, On the Forward Kinematics of Cable-Driven Parallel Robots, 2015 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS), Hamburg, Germany, 2015.

\bibitem{quaternions2} J. Pujol, Hamilton, Rodrigues, Gauss, Quaternions, and Rotations: a Historical Reassessment, Commun. Math. Anal., Volume 13, Number 2 (2012), 1-14.

\bibitem{shoemake} Ken Shoemake, Animating Rotation with Quaternion Curves, SIGGRAPH 1985, \url{https://www.cs.cmu.edu/~kiranb/animation/p245-shoemake.pdf}.

\bibitem{ros} Stanford Artificial Intelligence Laboratory et al., Robotic Operating System, \url{https://www.ros.org}, 2018.

\bibitem{schilling1}  M. Schilling, Universally manipulable body models---dual quaternion representations in layered and dynamic MMCs, Auton Robot 30, 399 (2011), \url{https://doi.org/10.1007/s10514-011-9226-3 https://link.springer.com/article/10.1007/s10514-011-9226-3}.

\bibitem{schilling2} M. Schilling, Hierarchical Dual Quaternion-Based Recurrent Neural Network as a Flexible Internal Body Model, 2019 International Joint Conference on Neural Networks (IJCNN), 2019, pp. 1-8, doi: 10.1109/IJCNN.2019.8852328, \url{https://ieeexplore.ieee.org/abstract/document/8852328}.

\bibitem{wang-et-al} Xiangke Wang, Dapeng Han, Changbin Yu, and Zhiqiang Zheng, The geometric structure of unit dual quaternions with application in kinematic control, Journal of Mathematical Analysis and Applications 389(2), 2012, 1352-1364.

\bibitem{wiki0} Wikipedia, Hodge star operator, \url{https://en.wikipedia.org/wiki/Hodge_star_operator#Three_dimensions}.

\bibitem{wiki1} Wikipedia, Lie derivative, \url{https://en.wikipedia.org/wiki/Lie_derivative}.

\bibitem{wiki2} Wikipedia, Lie group-Lie algebra correspondence, \url{https://en.wikipedia.org/wiki/Lie_group%E2%80%93Lie_algebra_correspondence}.

\bibitem{yano} K. Yano, The Theory of Lie Derivatives and its Applications, North-Holland ISBN 978-0-7204-2104-0, 1957.

\bibitem{yang-et-al} XiaoLong Yang, HongTao Wu, Yao Li, Bai Chen, A dual quaternion solution to the forward kinematics of a class of six-DOF parallel robots with full or reductant actuation, Mechanism and Machine Theory 107 (2017) 27-36, \url{http://dx.doi.org/10.1016/j.mechmachtheory.2016.08.003}.

\end{thebibliography}

\section*{Appendix: summary of notation}

Scalars (or scalar valued functions) are generally represented by lower case Roman letters, the exception being $\ell$ for actuator values.  3-vectors are represented by bold face Roman letters.  Dual quaternions and 6-vectors are represented by lower case Greek letters.  Quaternions are generally represented by upper case Roman letters, except since pure quaternions can be identified with 3-vectors, they are often instead denoted by bold face lower case Roman letters.

Matrices are represented by san-serif capital letters, either Roman or Greek.  Functions taking vectors to vectors are represented by san-serif capital Roman letters, or by the font corresponding to the type of the output of the function.

The following list gives examples of notation that is commonly used in this paper.  We try to restrict ourselves to notation that is used in several places throughout the paper.

\begin{itemize}
\item $t$: time.
\item $\dot g$: time derivative of $g$.
\item $\ddot g$: second time derivative of $g$.
\item $\bi$, $\bj$, $\bk$: standard unit 3-vectors/quaternions.
\item $\overline A$: conjugate of the quaternion $A$.
\item $|A| = \sqrt{A\overline A}$: norm of the quaternion $A$ (scalar).
\item $\realpart(A) = \tfrac12(A + \overline A)$: real part of the quaternion $A$ (scalar).
\item $\imagpart(A) = \tfrac12(A - \overline A)$: imaginary part of the quaternion $A$ (3-vector/quaternion).
\item $\widehat{A} = A/|A|$: normalization of the quaternion $A$ (unit quaternion).
\item $A \cdot B = \realpart(A \overline B)$: dot product of quaternions $A$ and $B$ (scalar).
\item $\mathsf R$: orthogonal matrix representing rotation ($(3 \times 3)$ matrix).
\item $Q = \cos(\tfrac12 a) + \bm s \sin(\tfrac12 a)$: quaternion representing rotation about axis $\bm s$ by angle $a$ (unit quaternion).
\item $\bm t$: translation (3-vector).
\item $\epsilon$: dual quaternion such that $\epsilon^2 = 0$.
\item $l$: characteristic length scale (scalar).
\item $\|A + \epsilon B\| = \sqrt{|A|^2 + l^{-2} |B|^2}$: size of the dual quaternion $A + \epsilon B$ (scalar).
\item $\overline\eta$: conjugate of the dual quaternion $\eta$.
\item $|\eta| = \sqrt{\eta\overline\eta}$: norm of the dual quaternion $\eta$ (dual number).
\item $\widehat\eta = |\eta|^{-1} \eta$: normalization of the dual quaternion $\eta$.
\item $\setdualquat$: the set of dual quaternions.
\item $\setunitdualquat$: the set of unit dual quaternions.
\item $\setpuredualquat$: the set of pure dual quaternions.
\item $\eta = Q + \frac12 \epsilon \bm t Q$: pose (unit dual quaternion).
\item $\|\eta\|$: size of the dual quaternion $\eta$ (scalar).
\item $\bm w$: angular velocity (3-vector).
\item $\starop{\bm w}$: Hodge star operator of $\bm w$ ($(3\times3)$-matrix).
\item $\bm v$: translational velocity (3-vector).
\item $\varphi = \frac12\bm w + \frac12\epsilon \bm v$: twist (pure dual quaternion).
\item $\alpha = \dot\varphi$: acceleration (pure dual quaternion).
\item $\bm q$: torque (3-vector).
\item $\bm p$: force (3-vector).
\item $\tau = 2\bm q + 2 \epsilon \bm p$: wrench (pure) dual quaternion.
\item $\bm r_0$: center of mass of end effector (3-vector).
\item $\theta$: perturbation of pose (pure dual quaternion).
\item $\eta_1 \liediff \eta_2 = \tfrac12(\overline\eta_2\eta_1 - \overline\eta_1 \eta_2)$: Lie difference of $\eta_1$ and $\eta_2$ (pure dual quaternion).
\item $\beta_i$: basis element dual quaternion.
\item $\eta_1 \cdot \eta_2$: dot product of dual quaternions as vectors (scalar).
\item $\liederiv_\theta g$: directional Lie derivative of $g$ (same type as $g$).
\item $\liederiv_i g$: partial Lie derivative of $g$ (same type as $g$).
\item $\liederiv g$: full Lie derivative of $g$ (pure dual quaternion).
\item $\bm \ell$: actuator values ($n$-vector).
\item $\bm f$: actuator forces ($n$-vector).
\item $\mathsf L$: function that converts $\eta$ to $\bm \ell$.
\item $\mathsf \Lambda = \liederiv\mathsf L$: matrix that converts $\varphi$ to $\dot{\bm \ell}$.
\item $\mathsf T = \mathsf\Lambda^T$: matrix that converts $\bm f$ to $\tau$.
\item $\left[\frac{\partial^2g}{\partial\eta^2}\right]$: Hessian matrix of $g$ ($(8 \times 8)$ matrix).
\item $\mathsf Y$: function that converts $\bm\ell$ to $\eta$.
\item $\bm f_0$: no-load actuator forces ($n$-vector).
\item $\mathsf M_0$: effective no-load moment of inertia of actuators ($(n\times n)$ matrix).
\item $m_e$: mass of the end effector (scalar).
\item $\mathsf M_e$: moment of inertia of end effector ($(3\times3)$ matrix).
\item $\bm g$: acceleration due to gravity (3-vector).
\item $\tilde{\bm g} = \overline Q \bm g Q$: acceleration due to gravity in moving frame of reference (3-vector).
\item $\mathsf M$: effective mass of the parallel robot ($(6\times6)$ matrix).
\item $\mu$: additive term used in converting acceleration $\alpha$ to wrench $\tau$ (pure dual quaternion).
\end{itemize}

\end{document}
